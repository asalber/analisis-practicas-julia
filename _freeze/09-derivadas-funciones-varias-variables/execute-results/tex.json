{
  "hash": "98f4b649b8c1e4893aa2a45dfecb9969",
  "result": {
    "markdown": "---\ntitle: Derivadas de funciones de varias variables\nlang: es\n#jupyter: julia-1.9\n---\n\n## Ejercicios Resueltos\n\nPara la realización de esta práctica se requieren los siguientes paquetes:\n\n::: {.cell execution_count=1}\n``` {.julia .cell-code}\nusing SymPy  # Para el cálculo simbólico.\nusing Plots  # Para el dibujo de gráficas.\nusing Makie, GLMakie # Para el dibujo de gráficas en 3d.\nusing ImplicitPlots # Para el dibujo de gráficas de funciones implícitas.\nusing LaTeXStrings  # Para usar código LaTeX en los gráficos.\nusing LinearAlgebra # Para el módulo y el producto escalar de vectores.\n```\n:::\n\n\n:::{#exr-superficies}\nDibujar las gráficas de las siguientes funciones.\n\na.  $f(x,y) = 2x + 3y$.\n\n    :::{.callout-note collapse=\"true\"}\n    ## Ayuda\n    Usar la función [`surface`](https://aprendeconalf.es/manual-julia/graficos.html#gr%C3%A1ficos-en-el-espacio-real) del paquete `Plots` o la función [`surface`](https://aprendeconalf.es/manual-julia/graficos.html#superficies) del paquete `Makie` para representar superficies de funciones de dos variables.\n    :::\n\n    :::{.callout-tip collapse=\"true\"}\n    ## Solución\n\n    :::{.panel-tabset}\n    ## Plots\n\n\n    ::: {.cell execution_count=2}\n    ``` {.julia .cell-code}\n    using Plots\n    f(x, y) = x/2 - 2y\n    xs = ys = range(0, 2, 2)\n    Plots.surface(xs, ys, f, xlab = \"x\", ylab = \"y\", zlab = \"z\")\n    ```\n    \n    ::: {.cell-output .cell-output-display execution_count=3}\n    ![](09-derivadas-funciones-varias-variables_files/figure-pdf/cell-3-output-1.svg){fig-pos='H'}\n    :::\n    :::\n    \n    \n    ## Makie\n\n\n    ::: {.cell execution_count=3}\n    ``` {.julia .cell-code}\n    using GLMakie\n    f(x, y) = x/2 - 2y\n    xs = ys = range(0, 2, 2)\n    Makie.surface(xs, ys, f)\n    ```\n    \n    ::: {.cell-output .cell-output-display execution_count=4}\n    ![](09-derivadas-funciones-varias-variables_files/figure-pdf/cell-4-output-1.png){fig-pos='H'}\n    :::\n    :::\n    \n    \n    :::\n    :::\n\na.  $g(x) = x^2 - y^2$.\n\n    :::{.callout-tip collapse=\"true\"}\n    ## Solución\n\n    :::{.panel-tabset}\n    ## Plots\n\n\n    ::: {.cell execution_count=4}\n    ``` {.julia .cell-code}\n    using Plots\n    g(x, y) = x^2-y^2\n    xs = ys = range(-1, 1, 30)\n    Plots.surface(xs, ys, g, xlab = \"x\", ylab = \"y\", zlab = \"z\")\n    ```\n    \n    ::: {.cell-output .cell-output-display execution_count=5}\n    ![](09-derivadas-funciones-varias-variables_files/figure-pdf/cell-5-output-1.svg){fig-pos='H'}\n    :::\n    :::\n    \n    \n    ## Makie\n\n\n    ::: {.cell execution_count=5}\n    ``` {.julia .cell-code}\n    using GLMakie\n    g(x, y) = x^2 - y^2\n    xs = ys = range(-1, 1, 30)\n    Makie.surface(xs, ys, g)\n    ```\n    \n    ::: {.cell-output .cell-output-display execution_count=6}\n    ![](09-derivadas-funciones-varias-variables_files/figure-pdf/cell-6-output-1.png){fig-pos='H'}\n    :::\n    :::\n    \n    \n    :::\n    :::\n\na.  $h(x) = \\dfrac{\\operatorname{sen}(x^2+y^2)}{\\sqrt{x^2+y^2}}$\n\n    :::{.callout-tip collapse=\"true\"}\n    ## Solución\n\n    :::{.panel-tabset}\n    ## Plots\n\n\n    ::: {.cell execution_count=6}\n    ``` {.julia .cell-code}\n    using Plots\n    h(x, y) = sin(x^2+y^2)/sqrt(x^2+y^2)\n    xs = ys = range(-pi, pi, 80)\n    Plots.surface(xs, ys, h, xlab = \"x\", ylab = \"y\", zlab = \"z\")\n    ```\n    \n    ::: {.cell-output .cell-output-display execution_count=7}\n    ![](09-derivadas-funciones-varias-variables_files/figure-pdf/cell-7-output-1.svg){fig-pos='H'}\n    :::\n    :::\n    \n    \n    ## Makie\n\n\n    ::: {.cell execution_count=7}\n    ``` {.julia .cell-code}\n    using GLMakie\n    h(x, y) = sin(x^2+y^2)/sqrt(x^2+y^2)\n    xs = ys = range(-pi, pi, 80)\n    Makie.surface(xs, ys, h)\n    ```\n    \n    ::: {.cell-output .cell-output-display execution_count=8}\n    ![](09-derivadas-funciones-varias-variables_files/figure-pdf/cell-8-output-1.png){fig-pos='H'}\n    :::\n    :::\n    \n    \n    :::\n    :::\n:::\n\n:::{#exr-curvas-nivel}\nDibujar las curvas de nivel de las siguientes funciones.\n\na.  $f(x,y) = 2x + 3y$.\n\n    :::{.callout-note collapse=\"true\"}\n    ## Ayuda\n    Usar la función [`contour`](https://docs.juliaplots.org/stable/series_types/contour/) del paquete `Plots` o la función [`contour`](https://docs.makie.org/stable/reference/plots/contour/index.html) del paquete `Makie` para representar curvas de nivel de funciones de dos variables.\n    :::\n\n    :::{.callout-tip collapse=\"true\"}\n    ## Solución\n\n    :::{.panel-tabset}\n    ## Plots\n\n\n    ::: {.cell execution_count=8}\n    ``` {.julia .cell-code}\n    using Plots\n    f(x, y) = x/2 - 2y\n    xs = ys = range(0, 2, 50)\n    Plots.contour(xs, ys, f, levels = 7, xlab = \"x\", ylab = \"y\", clabels = true)\n    ```\n    \n    ::: {.cell-output .cell-output-display execution_count=9}\n    ![](09-derivadas-funciones-varias-variables_files/figure-pdf/cell-9-output-1.svg){fig-pos='H'}\n    :::\n    :::\n    \n    \n    ## Makie\n\n\n    ::: {.cell execution_count=9}\n    ``` {.julia .cell-code}\n    using GLMakie\n    f(x, y) = x/2 - 2y\n    xs = ys = range(0, 2, 50)\n    Makie.contour(xs, ys, f, labels = true,  levels = 0:-0.5:-3)\n    ```\n    \n    ::: {.cell-output .cell-output-display execution_count=10}\n    ![](09-derivadas-funciones-varias-variables_files/figure-pdf/cell-10-output-1.png){fig-pos='H'}\n    :::\n    :::\n    \n    \n    :::\n    :::\n\na.  $g(x) = x^2 - y^2$.\n\n    :::{.callout-tip collapse=\"true\"}\n    ## Solución\n\n    :::{.panel-tabset}\n    ## Plots\n\n\n    ::: {.cell execution_count=10}\n    ``` {.julia .cell-code}\n    using Plots\n    g(x, y) = x^2 - y^2\n    xs = ys = range(-1, 1, 100)\n    Plots.contour(xs, ys, g, levels = 9, xlab = \"x\", ylab = \"y\", clabels = true)\n    ```\n    \n    ::: {.cell-output .cell-output-display execution_count=11}\n    ![](09-derivadas-funciones-varias-variables_files/figure-pdf/cell-11-output-1.svg){fig-pos='H'}\n    :::\n    :::\n    \n    \n    ## Makie\n\n\n    ::: {.cell execution_count=11}\n    ``` {.julia .cell-code}\n    using GLMakie\n    f(x, y) = x^2 - y^2\n    xs = ys = range(-1, 1, 100)\n    Makie.contour(xs, ys, f, labels = true,  levels = -1:0.2:1)\n    ```\n    \n    ::: {.cell-output .cell-output-display execution_count=12}\n    ![](09-derivadas-funciones-varias-variables_files/figure-pdf/cell-12-output-1.png){fig-pos='H'}\n    :::\n    :::\n    \n    \n    :::\n    :::\n\na.  $h(x) = \\dfrac{\\operatorname{sen}(x^2+y^2)}{\\sqrt{x^2+y^2}}$\n\n    :::{.callout-tip collapse=\"true\"}\n    ## Solución\n\n    :::{.panel-tabset}\n    ## Plots\n\n\n    ::: {.cell execution_count=12}\n    ``` {.julia .cell-code}\n    using Plots\n    h(x, y) = sin(x^2+y^2)/sqrt(x^2+y^2)\n    xs = ys = range(-pi, pi, 80)\n    Plots.contour(xs, ys, h, xlab = \"x\", ylab = \"y\")\n    ```\n    \n    ::: {.cell-output .cell-output-display execution_count=13}\n    ![](09-derivadas-funciones-varias-variables_files/figure-pdf/cell-13-output-1.svg){fig-pos='H'}\n    :::\n    :::\n    \n    \n    ## Makie\n\n\n    ::: {.cell execution_count=13}\n    ``` {.julia .cell-code}\n    using GLMakie\n    h(x, y) = sin(x^2+y^2)/sqrt(x^2+y^2)\n    xs = ys = range(-pi, pi, 80)\n    Makie.contour(xs, ys, h, labels = true,  levels = -1:0.2:1)\n    ```\n    \n    ::: {.cell-output .cell-output-display execution_count=14}\n    ![](09-derivadas-funciones-varias-variables_files/figure-pdf/cell-14-output-1.png){fig-pos='H'}\n    :::\n    :::\n    \n    \n    :::\n    :::\n:::\n\n:::{#exr-superficie-curvas-nivel}\nDibujar en una misma gráfica la superficie de la función $f(x,y) = -4x e^{-x^2-y^2}$ y sus curvas de nivel.\n\n:::{.callout-tip collapse=\"true\"}\n## Solución\n\n::: {.cell execution_count=14}\n``` {.julia .cell-code}\nusing GLMakie\nf(x, y) = -4x*exp(-x^2-y^2)\nxs = ys = range(-2, 2, 50)\nzs = f.(xs, ys')\nzmin = minimum(zs)\nfig = Figure()\nax = Axis3(fig[1,1], )\nsurf = Makie.surface!(ax, xs, ys, zs, transparency = true)\nMakie.wireframe!(ax, xs, ys, zs, color = (:black, 0.1), transparency = true)\nMakie.contour!(ax, xs, ys, zs, levels = 20, transformation = (:xy, zmin), transparency=true)\nColorbar(fig[1, 2], surf, height = Relative(0.5))\nfig\n```\n\n::: {.cell-output .cell-output-display execution_count=15}\n![](09-derivadas-funciones-varias-variables_files/figure-pdf/cell-15-output-1.png){fig-pos='H'}\n:::\n:::\n\n\n:::\n:::\n\n\n:::{#exr-derivada-parcial}\nSea $f(x,y)= x^2-2y^2$.\n\na.  Dibujar la gráfica y el punto $(1, 1, f(1,1))$.\n\n    :::{.callout-note collapse=\"true\"}\n    ## Ayuda\n    Usar la función [`surface`](https://aprendeconalf.es/manual-julia/graficos.html#superficies) del paquete `Makie` para representar superficies de funciones de dos variables. \n\n    Usar la función [`scatter`](https://aprendeconalf.es/manual-julia/graficos.html#diagrama-de-puntos) del paquete Makie para dibujar puntos.\n    :::\n\n    :::{.callout-tip collapse=\"true\"}\n    ## Solución\n\n\n    ::: {.cell execution_count=15}\n    ``` {.julia .cell-code}\n    using GLMakie\n    f(x, y) = x^2 - 2y^2\n    xs = ys = range(-2, 2, 30)\n    fig = Figure()\n    ax = Axis3(fig[1,1], azimuth = pi/4)\n    Makie.surface!(ax, xs, ys, f, transparency = true)\n    Makie.scatter!(ax, Point3(1, 1, f(1,1)), color = :red)\n    fig\n    ```\n    \n    ::: {.cell-output .cell-output-display execution_count=16}\n    ![](09-derivadas-funciones-varias-variables_files/figure-pdf/cell-16-output-1.png){fig-pos='H'}\n    :::\n    :::\n    \n    \n    :::\n\na.  Dibujar el plano $y=1$ sobre la superficie. ¿Cuál es la curva que resulta de la intersección del plano con la superficie? ¿Cómo es la pendiente de la tangente a esta curva en $x=1$?\n\n    :::{.callout-tip collapse=\"true\"}\n    ## Solución\n\n\n    ::: {.cell execution_count=16}\n    ``` {.julia .cell-code}\n    xs = [-2 -2; 2 2]\n    zs = [-6 2; -6 2]\n    ys = [1 1; 1 1]\n    Makie.surface!(ax, xs, ys, zs; colormap = [:orange])\n    fig\n    ```\n    \n    ::: {.cell-output .cell-output-display execution_count=17}\n    ![](09-derivadas-funciones-varias-variables_files/figure-pdf/cell-17-output-1.png){fig-pos='H'}\n    :::\n    :::\n    \n    \n    La curva resultante es la parábola $f(x) = x^2$. La pendiente de la recta tangente a esta curva en $x=1$ vale $2$.\n    :::\n\na.  Calcular la derivada parcial de $f$ con respecto a $x$ en el punto $(1,1)$.\n\n    :::{.callout-tip collapse=\"true\"}\n    ## Solución\n\n\n    ::: {.cell execution_count=17}\n    ``` {.julia .cell-code}\n    using SymPy\n    @syms x y\n    subs(diff(f(x,y), x), x => 1, y => 1)\n    ```\n    \n    ::: {.cell-output .cell-output-display execution_count=18}\n    ```{=tex}\n    $2$\n    ```\n    :::\n    :::\n    \n    \n    :::\n\na.  Dibujar el plano $x=1$ sobre la superficie. ¿Cuál es la curva que resulta de la intersección del plano con la superficie? ¿Cómo es la pendiente de la tangente a esta curva en $y=1$?\n\n    :::{.callout-tip collapse=\"true\"}\n    ## Solución\n\n\n    ::: {.cell execution_count=18}\n    ``` {.julia .cell-code}\n    ys = [-2 -2; 2 2]\n    zs = [-6 2; -6 2]\n    xs = [1 1; 1 1]\n    Makie.surface!(ax, xs, ys, zs; colormap = [:magenta])\n    fig\n    ```\n    \n    ::: {.cell-output .cell-output-display execution_count=19}\n    ![](09-derivadas-funciones-varias-variables_files/figure-pdf/cell-19-output-1.png){fig-pos='H'}\n    :::\n    :::\n    \n    \n    La curva resultante es la parábola $g(y) = -2y^2$. La pendiente de la recta tangente a esta curva en $y=1$ vale $-4$.\n    :::\n\na.  Calcular la derivada parcial de $f$ con respecto a $y$ en el punto $(1,1)$.\n\n    :::{.callout-tip collapse=\"true\"}\n    ## Solución\n\n\n    ::: {.cell execution_count=19}\n    ``` {.julia .cell-code}\n    using SymPy\n    @syms x y\n    subs(diff(f(x,y), y), x => 1, y => 1)\n    ```\n    \n    ::: {.cell-output .cell-output-display execution_count=20}\n    ```{=tex}\n    $-4$\n    ```\n    :::\n    :::\n    \n    \n    :::\n:::\n\n:::{#exr-derivadas-parciales}\nLa presión $P$ de un gas perfecto depende de la temperatura $T$ y del volumen que ocupa $V$ según la función \n\n$$\nP(T,V) = \\frac{nRT}{V},\n$$\n\ndonde $n$ y $R$ son constantes positivas propias de cada gas.\n\na.  Calcular la derivada parcial de la presión con respecto a la temperatura. ¿Cómo la interpretarías?\n\n    :::{.callout-tip collapse=\"true\"}\n    ## Solución\n\n\n    ::: {.cell execution_count=20}\n    ``` {.julia .cell-code}\n    using SymPy\n    @syms n R T V\n    diff(n*R*T/V, T)\n    ```\n    \n    ::: {.cell-output .cell-output-display execution_count=21}\n    ```{=tex}\n    $\\frac{R n}{V}$\n    ```\n    :::\n    :::\n    \n    \n    Como $n$, $R$ y $V$ son positivos, la derivada parcial es positiva, por lo que si se mantiene el volumen constante y empezamos a aumentar la temperatura, la presión aumentará.\n    :::\n\na.  Calcular la derivada parcial de la presión con respecto al volumen. ¿Cómo la interpretarías?\n\n    :::{.callout-tip collapse=\"true\"}\n    ## Solución\n\n\n    ::: {.cell execution_count=21}\n    ``` {.julia .cell-code}\n    diff(n*R*T/V, V)\n    ```\n    \n    ::: {.cell-output .cell-output-display execution_count=22}\n    ```{=tex}\n    $- \\frac{R T n}{V^{2}}$\n    ```\n    :::\n    :::\n    \n    \n    Como $n$, $R$, $T$ y $V$ son positivos, la derivada parcial es negativa, por lo que si se mantiene la temperatura constante y empezamos a aumentar el volumen, la presión disminuirá.\n    :::\n:::\n\n:::{#exr-igualdad-derivadas-cruzadas}\nDada la función $f(x,y) = e^{x+y}\\operatorname{sen}\\left(\\frac{x}{y}\\right)$, calcular las siguientes derivadas parciales de segundo orden.\n\na.  $\\dfrac{\\partial^2f}{\\partial y\\partial x}$.\n\n    :::{.callout-tip collapse=\"true\"}\n    ## Solución\n\n\n    ::: {.cell execution_count=22}\n    ``` {.julia .cell-code}\n    using SymPy\n    @syms x y\n    f(x, y) = exp(x+y)sin(x/y)\n    diff(f(x, y), x, y)\n    ```\n    \n    ::: {.cell-output .cell-output-display execution_count=23}\n    ```{=tex}\n    $\\left(- \\frac{x \\cos{\\left(\\frac{x}{y} \\right)}}{y^{2}} + \\frac{x \\sin{\\left(\\frac{x}{y} \\right)}}{y^{3}} + \\sin{\\left(\\frac{x}{y} \\right)} + \\frac{\\cos{\\left(\\frac{x}{y} \\right)}}{y} - \\frac{\\cos{\\left(\\frac{x}{y} \\right)}}{y^{2}}\\right) e^{x + y}$\n    ```\n    :::\n    :::\n    \n    \n    :::\n\na.  $\\dfrac{\\partial^2f}{\\partial x\\partial y}$.\n\n    :::{.callout-tip collapse=\"true\"}\n    ## Solución\n\n\n    ::: {.cell execution_count=23}\n    ``` {.julia .cell-code}\n    using SymPy\n    @syms x y\n    f(x, y) = exp(x+y)sin(x/y)\n    diff(f(x, y), y, x)\n    ```\n    \n    ::: {.cell-output .cell-output-display execution_count=24}\n    ```{=tex}\n    $\\left(- \\frac{x \\cos{\\left(\\frac{x}{y} \\right)}}{y^{2}} + \\frac{x \\sin{\\left(\\frac{x}{y} \\right)}}{y^{3}} + \\sin{\\left(\\frac{x}{y} \\right)} + \\frac{\\cos{\\left(\\frac{x}{y} \\right)}}{y} - \\frac{\\cos{\\left(\\frac{x}{y} \\right)}}{y^{2}}\\right) e^{x + y}$\n    ```\n    :::\n    :::\n    \n    \n    :::\n\na.  ¿Se cumple la igualdad de las derivadas cruzadas?\n\n    :::{.callout-tip collapse=\"true\"}\n    ## Solución\n    Si, $\\dfrac{\\partial^2f}{\\partial y\\partial x} = \\dfrac{\\partial^2f}{\\partial x\\partial y}$, porque ambas derivadas son continuas en todo su dominio.\n    :::\n:::\n\n:::{#exr-gradiente}\nLa función $f(x, y, z) = e^{-x-2y-3z}$ da la temperatura en cada posición $(x,y,z)$ de una habitación. \n\na.  Si un mosquito está en la posición $(1, 1, 1)$, ¿en qué dirección debe volar para que la temperatura decrezca lo más rápidamente posible? ¿Cuál será la tasa de variación de la temperatura si el mosquito se mueve en esa dirección? \n\n    :::{.callout-note collapse=\"true\"}\n    ## Ayuda\n    Debe moverse en la dirección opuesta al [vector gradiente](https://aprendeconalf.es/analisis-manual/13-derivadas-funciones-varias-variables.html#vector-gradiente) de $f$.\n    :::\n\n    :::{.callout-tip collapse=\"true\"}\n    ## Solución\n\n    :::{.panel-tabset}\n    ## Solución 1\n\n\n    ::: {.cell execution_count=24}\n    ``` {.julia .cell-code}\n    using SymPy, LinearAlgebra\n    @syms x y z\n    f(x, y, z) = exp(-x-2y-3z)\n    ex = diff.(f(x, y, z), [x, y, z])\n    ∇f = lambdify(ex, (x, y, z))\n    println(\"Dirección de máximo decrecimiento : $(-∇f(1, 1, 1))\")\n    println(\"Tasa de variación en esa dirección: $(-norm(∇f(1, 1, 1)))\")\n    ```\n    \n    ::: {.cell-output .cell-output-stdout}\n    ```\n    Dirección de máximo decrecimiento : [0.0024787521766663585, 0.004957504353332717, 0.0074362565299990755]\n    Tasa de variación en esa dirección: -0.009274641391805666\n    ```\n    :::\n    :::\n    \n    \n    ## Solución 2\n\n\n    ::: {.cell execution_count=25}\n    ``` {.julia .cell-code}\n    using SymPy, LinearAlgebra\n    @syms x y z\n    f(x, y, z) = exp(-x-2y-3z)\n    ex = [diff(f(x,y,z), i) for i in (x, y, z)]\n    ∇f = lambdify(ex, (x, y, z))\n    println(\"Dirección de máximo decrecimiento : $(-∇f(1, 1, 1))\")\n    println(\"Tasa de variación en esa dirección: $(-norm(∇f(1, 1, 1)))\")\n    ```\n    \n    ::: {.cell-output .cell-output-stdout}\n    ```\n    Dirección de máximo decrecimiento : [0.0024787521766663585, 0.004957504353332717, 0.0074362565299990755]\n    Tasa de variación en esa dirección: -0.009274641391805666\n    ```\n    :::\n    :::\n    \n    \n    :::\n    :::\n\na.  Si el mosquito se mueve siguiendo la dirección del vector $(2, -1, 3)$, ¿la temperatura aumenta o disminuye? ¿Cuál será la tasa de variación de la temperatura en esa dirección?\n\n    :::{.callout-note collapse=\"true\"}\n    ## Ayuda\n    La tasa de variación de la función viene dada por la [derivada direccional](https://aprendeconalf.es/analisis-manual/13-derivadas-funciones-varias-variables.html#derivada-direccional) de la función en el punto $(1, 1, 1)$ siguiendo la dirección del vector $(2, -1, 3)$.\n    :::\n\n    :::{.callout-tip collapse=\"true\"}\n    ## Solución\n\n\n    ::: {.cell execution_count=26}\n    ``` {.julia .cell-code}\n    dot(∇f(1, 1, 1), normalize([2, -1, 3]))\n    ```\n    \n    ::: {.cell-output .cell-output-display execution_count=27}\n    ```\n    -0.005962269466160785\n    ```\n    :::\n    :::\n    \n    \n    La temperatura disminuye.\n    :::\n:::\n\n:::{#exr-recta-normal-plano-tangente}\nCalcular las ecuaciones de la recta normal y el plano tangente a la superficie $x+2y-\\ln(z)+4=0$ en el punto $(0,-2,1)$, y dibujarlos.\n\n:::{.callout-note collapse=\"true\"}\n## Ayuda\nUsar la propiedad de que el vector gradiente de una función $f(x,y,z)$ es siempre normal a las curvas de nivel $f(x,y,z)=0$.\n:::\n\n:::{.callout-tip collapse=\"true\"}\n## Solución\nDibujamos primero la superficie. \n\n::: {.cell execution_count=27}\n``` {.julia .cell-code}\nusing SymPy, GLMakie\nf(x, y, z) = x + 2y - log(z) + 4\n@syms x y z\nf1 = lambdify(solve(f(x,y,z), z)[1])\nxs = range(-0.5, 0.5, 30)\nys = range(-2.5, -1.5, 30)\nfig = Figure()\nax = Axis3(fig[1,1], aspect = :data)\nMakie.surface!(ax, xs, ys, f1)\nMakie.scatter!(ax, Point3(0, -2, 1), color = :red)\nfig\n```\n\n::: {.cell-output .cell-output-display execution_count=28}\n![](09-derivadas-funciones-varias-variables_files/figure-pdf/cell-28-output-1.png){fig-pos='H'}\n:::\n:::\n\n\nCalculamos primero la ecuación de la recta normal.\n\n::: {.cell execution_count=28}\n``` {.julia .cell-code}\nusing SymPy\nex = diff.(f(x, y, z), [x, y, z])\n∇f = lambdify(ex, (x, y, z))\nnl(t) = [0, -2, 1] + t*∇f(0, -2, 1) \n@syms t\nprintln(\"Ecuación de la recta normal $(nl(t))\")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nEcuación de la recta normal Sym[t, 2*t - 2, 1 - 1.0*t]\n```\n:::\n:::\n\n\nY la dibujamos sobre la misma gráfica de la superficie.\n\n::: {.cell execution_count=29}\n``` {.julia .cell-code}\nts = range(-0.5, 0.5, 2)\npoints = Point3.(nl.(ts))\nMakie.lines!(ax, points)\nfig\n```\n\n::: {.cell-output .cell-output-display execution_count=30}\n![](09-derivadas-funciones-varias-variables_files/figure-pdf/cell-30-output-1.png){fig-pos='H'}\n:::\n:::\n\n\nA continuación calculamos la ecuación del plano tangente.\n\n::: {.cell execution_count=30}\n``` {.julia .cell-code}\nusing LinearAlgebra\ntp(x,y) = solve(dot(([x, y, z] - [0, -2, 1]), ∇f(0, -2, 1)), z)[1]\nprintln(\"Ecuación del plano tangente z = $(tp(x,y))\")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nEcuación del plano tangente z = x + 2.0*y + 5.0\n```\n:::\n:::\n\n\nY finalmente lo dibujamos en la misma gráfica de la superficie.\n\n::: {.cell execution_count=31}\n``` {.julia .cell-code}\nMakie.surface!(ax, xs, ys, tp, colormap = [\"red\"], alpha = 0.5, transparency = true)\nfig\n```\n\n::: {.cell-output .cell-output-display execution_count=32}\n![](09-derivadas-funciones-varias-variables_files/figure-pdf/cell-32-output-1.png){fig-pos='H'}\n:::\n:::\n\n\n:::\n:::\n\n:::{#exr-derivadas-implicitas}\nLa ecuación $x^3+y^3=8$ define una curva implícita.\n\na.  Dibujar la gráfica de la ecuación.\n\n    :::{.callout-note collapse=\"true\"}\n    ## Ayuda\n    Usar la función [`implicit_plot`](https://juliapackages.com/p/implicitplots) del paquete `ImplicitPlots` para dibujar la gráfica de una función implícita definida por una ecuación.\n    :::\n\n    :::{.callout-tip collapse=\"true\"}\n    ## Solución\n\n\n    ::: {.cell execution_count=32}\n    ``` {.julia .cell-code}\n    using Plots, ImplicitPlots, LaTeXStrings\n    f(x, y) = x^3 + y^3 - 8 \n    implicit_plot(f, xlab =  L\"$x$\", ylab = L\"$y$\", legend = false)\n    ```\n    \n    ::: {.cell-output .cell-output-display execution_count=33}\n    ![](09-derivadas-funciones-varias-variables_files/figure-pdf/cell-33-output-1.svg){fig-pos='H'}\n    :::\n    :::\n    \n    \n    :::\n\na.  Calcular la derivada de $y$ como función implícita de $x$.\n\n    :::{.callout-note collapse=\"true\"}\n    ## Ayuda\n    La derivada de $y$ como función implícita de $x$ en la ecuación $f(x,y)=0$ se puede calcular como\n\n    $$\n    \\frac{dy}{dx} = -\\frac{\\partial f/\\partial x}{\\partial f/\\partial y}\n    $$\n    :::\n\n    :::{.callout-tip collapse=\"true\"}\n    ## Solución\n\n\n    ::: {.cell execution_count=33}\n    ``` {.julia .cell-code}\n    using SymPy\n    @syms x y u()\n    y′ = -diff(f(x, y), x) / diff(f(x, y), y)\n    ```\n    \n    ::: {.cell-output .cell-output-display execution_count=34}\n    ```{=tex}\n    $- \\frac{x^{2}}{y^{2}}$\n    ```\n    :::\n    :::\n    \n    \n    :::\n\na.  Calcular la ecuación de la recta tangente a la curva implícita en el punto $(\\sqrt[3]{4}, \\sqrt[3]{4})$.\n\n    :::{.callout-tip collapse=\"true\"}\n    ## Solución\n\n\n    ::: {.cell execution_count=34}\n    ``` {.julia .cell-code}\n    x₀ = y₀ = 2^(2/3)\n    tan = lambdify(y₀ + subs(y′, y => y₀, x => x₀)*(x-x₀))\n    Plots.plot!(tan)\n    ```\n    \n    ::: {.cell-output .cell-output-display execution_count=35}\n    ![](09-derivadas-funciones-varias-variables_files/figure-pdf/cell-35-output-1.svg){fig-pos='H'}\n    :::\n    :::\n    \n    \n    :::\n\n<!-- a.  Calcular la segunda derivada de $y$. ¿Cómo es la concavidad de la función en el punto $(\\sqrt[3]{4}, \\sqrt[3]{4})$? -->\n:::\n\n:::{#exr-extremos}\nLa función $f(x,y) = x^3+y^3-3xy$ determina la concentración de una sustancia $z$ en función de las concentraciones de otras dos $x$ e $y$ en una reacción química.\n\na.  Representar la gráfica de la función.\n\n    :::{.callout-tip collapse=\"true\"}\n    ## Solución\n\n\n    ::: {.cell execution_count=35}\n    ``` {.julia .cell-code}\n    using GLMakie\n    f(x, y) = x^3+y^3-3x*y\n    xs = ys = range(-0.5, 1.5, 30)\n    Makie.surface(xs, ys, f)\n    ```\n    \n    ::: {.cell-output .cell-output-display execution_count=36}\n    ![](09-derivadas-funciones-varias-variables_files/figure-pdf/cell-36-output-1.png){fig-pos='H'}\n    :::\n    :::\n    \n    \n    :::\n\na.  Calcular los puntos críticos de la función.\n\n    :::{.callout-note collapse=\"true\"}\n    ## Ayuda\n    Los puntos críticos son los puntos que anulan el gradiente. Para resolver el sistema de ecuaciones que resulta de igualar el vector gradiente al vector nulo se pueden utilizar las funciones [`linsolve`](https://docs.juliahub.com/SymPy/KzewI/1.2.1/Tutorial/solvers/#Solving-Equations-Algebraically) (para sistemas lineales) o [`nonlinsolve`](https://docs.juliahub.com/SymPy/KzewI/1.2.1/Tutorial/solvers/#Solving-Equations-Algebraically) (para sistemas no lineales) del paquete `SymPy`.\n    :::\n\n    :::{.callout-tip collapse=\"true\"}\n    ## Solución\n\n\n    ::: {.cell execution_count=36}\n    ``` {.julia .cell-code}\n    using SymPy\n    @syms x y\n    nonlinsolve(diff.(f(x, y), (x, y)), (x, y))\n    ```\n    \n    ::: {.cell-output .cell-output-display execution_count=37}\n    ```{=tex}\n    $\\left\\{\\left( 0, \\  0\\right), \\left( 1, \\  1\\right), \\left( - \\frac{1}{2} - \\frac{\\sqrt{3} i}{2}, \\  - \\frac{1}{2} + \\frac{\\sqrt{3} i}{2}\\right), \\left( - \\frac{1}{2} + \\frac{\\sqrt{3} i}{2}, \\  - \\frac{1}{2} - \\frac{\\sqrt{3} i}{2}\\right)\\right\\}$\n    ```\n    :::\n    :::\n    \n    \n    :::\n\na.  Determinar los extremos relativos y los puntos de silla. ¿Para qué concentraciones de $x$ e $y$ la concentración de $z$ será mínima?\n\n    :::{.callout-note collapse=\"true\"}\n    ## Ayuda\n    Para [determinar los extremos relativos y los puntos de silla](https://aprendeconalf.es/analisis-manual/13-derivadas-funciones-varias-variables.html#thm-extremos-funcion-dos-variables) de una función de dos variables, hay que calcular el hessiano en los puntos críticos.\n    :::\n\n    :::{.callout-tip collapse=\"true\"}\n    ## Solución\n\n    Definimos una función para el hessiano.\n\n\n    ::: {.cell execution_count=37}\n    ``` {.julia .cell-code}\n    using LinearAlgebra\n    hes = lambdify(det(hessian(f(x,y), (x,y))))\n    ```\n    \n    ::: {.cell-output .cell-output-display execution_count=38}\n    ```\n    #123 (generic function with 1 method)\n    ```\n    :::\n    :::\n    \n    \n    Calculamos el hessiano en el punto crítico $(0,0)$.\n\n\n    ::: {.cell execution_count=38}\n    ``` {.julia .cell-code}\n    hes(0,0)\n    ```\n    \n    ::: {.cell-output .cell-output-display execution_count=39}\n    ```\n    -9\n    ```\n    :::\n    :::\n    \n    \n    Como es negativo, en $(0,0)$ hay un punto de inflexión.\n\n    Calculamos el hessiano en el punto crítico $(1,1)$.\n\n\n    ::: {.cell execution_count=39}\n    ``` {.julia .cell-code}\n    hes(1,1)\n    ```\n    \n    ::: {.cell-output .cell-output-display execution_count=40}\n    ```\n    27\n    ```\n    :::\n    :::\n    \n    \n    Como es positivo, existe un extremo relativo en $(1,1)$. Para ver si se trata de un máximo o mínimo calculamos $\\frac{\\partial^2 f}{\\partial x^2}$.\n\n\n    ::: {.cell execution_count=40}\n    ``` {.julia .cell-code}\n    fxx = lambdify(diff(f(x,y), x, x), (x,y))\n    fxx(1,1)\n    ```\n    \n    ::: {.cell-output .cell-output-display execution_count=41}\n    ```\n    6\n    ```\n    :::\n    :::\n    \n    \n    Como es positiva, en $(1,1)$ hay un mínimo. Así pues, la concentración de $z$ será mínima cuando las concentraciones de $x$ e $y$ sean 1.\n    :::\n:::\n\n:::{#exr-polinomios-taylor}\nSea $f(x,y)=\\sqrt{xy}$.\n\na.  Dibujar la gráfica de $f$ y el punto $(1, 1, f(1,1))$.\n\n    :::{.callout-tip collapse=\"true\"}\n    ## Solución\n\n\n    ::: {.cell execution_count=41}\n    ``` {.julia .cell-code}\n    using GLMakie\n    f(x, y) = sqrt(x*y)\n    a = b = 1\n    xs = ys = range(0.5, 2, 30)\n    fig = Figure()\n    ax = Axis3(fig[1,1], azimuth = -pi/4, elevation = 0.1)\n    Makie.surface!(ax, xs, ys, f)\n    Makie.scatter!(ax, Point3(a, b, f(a,b)), color = :red)\n    fig\n    ```\n    \n    ::: {.cell-output .cell-output-display execution_count=42}\n    ![](09-derivadas-funciones-varias-variables_files/figure-pdf/cell-42-output-1.png){fig-pos='H'}\n    :::\n    :::\n    \n    \n    :::\n\na.  Calcular el polinomio de Taylor de primer grado de $f$ en el punto $(1,1)$ y representarlo gráficamente.\nComprobar que se obtiene el plano tangente a la superficie de $f$ en el punto $(1,1)$.\n\n    :::{.callout-note collapse=\"true\"}\n    ## Ayuda\n    La fórmula del polinomio de Taylor de primer grado de la función $f(x,y)$ en el punto $(a,b)$ es\n\n    $$\n    P^1(x,y) = f(a,b) + \\nabla f(a,b)(x-a, y-b).\n    $$\n    :::\n\n    :::{.callout-tip collapse=\"true\"}\n    ## Solución\n\n\n    ::: {.cell execution_count=42}\n    ``` {.julia .cell-code}\n    using SymPy, LinearAlgebra\n    @syms x, y\n    ex = diff.(f(x, y), [x, y])\n    ∇f = lambdify(ex, (x, y))\n    p1(s,t) = f(a, b) + dot(∇f(a, b), [s-a, t-b])\n    Makie.surface!(ax, xs, ys, p1; colormap = [:orange], transparency = true)\n    fig\n    ```\n    \n    ::: {.cell-output .cell-output-display execution_count=43}\n    ![](09-derivadas-funciones-varias-variables_files/figure-pdf/cell-43-output-1.png){fig-pos='H'}\n    :::\n    :::\n    \n    \n    :::\n\na.  Utilizar el polinomio anterior para calcular el valor aproximado de $\\sqrt{1.01\\cdot 0.99}$. ¿Cuál es el error cometido en la aproximación?\n\n    :::{.callout-tip collapse=\"true\"}\n    ## Solución\n\n\n    ::: {.cell execution_count=43}\n    ``` {.julia .cell-code}\n    error = abs(f(1.01, 0.99) - p1(1.01, 0.99))\n    ```\n    \n    ::: {.cell-output .cell-output-display execution_count=44}\n    ```\n    5.000125006249245e-5\n    ```\n    :::\n    :::\n    \n    \n    :::\n\na.  Calcular el polinomio de Taylor de segundo grado de $f$ en el punto $(1,1)$ y representarlo gráficamente.\n\n    :::{.callout-note collapse=\"true\"}\n    ## Ayuda\n    La fórmula del polinomio de Taylor de segundo grado de la función $f(x,y)$ en el punto $(a,b)$ es\n\n    $$\n    P^2(x,y) = f(a,b) + \\nabla f(a,b)(x-a, y-b) + \\frac{1}{2!}\\nabla^2f(a,b)(x-a,y-b)(x-a,y-b).\n    $$\n    :::\n\n    :::{.callout-tip collapse=\"true\"}\n    ## Solución\n\n\n    ::: {.cell execution_count=44}\n    ``` {.julia .cell-code}\n    using SymPy, LinearAlgebra\n    @syms x, y\n    ∇²f = lambdify(hessian(f(x,y), (x, y)), (x, y))\n    p2(s,t) = f(a, b) + dot(∇f(a, b), [s-a, t-b]) + 1/2 * dot(∇²f(a,b) * [s-a; t-b],  [s-a, t-b])\n    Makie.surface!(ax, xs, ys, p2; colormap = [:magenta], transparency = true)\n    fig\n    ```\n    \n    ::: {.cell-output .cell-output-display execution_count=45}\n    ![](09-derivadas-funciones-varias-variables_files/figure-pdf/cell-45-output-1.png){fig-pos='H'}\n    :::\n    :::\n    \n    \n    :::\n\na.  Utilizar el polinomio anterior para calcular el valor aproximado de $\\sqrt{1.01\\cdot 0.99}$.\n¿Cuál es error cometido en la aproximación? ¿Es mayor o menor que en la aproximación mediante el polinomio de Taylor de primer grado?\n\n    :::{.callout-tip collapse=\"true\"}\n    ## Solución\n\n\n    ::: {.cell execution_count=45}\n    ``` {.julia .cell-code}\n    error = f(1.01, 0.99) - p2(1.01, 0.99) \n    ```\n    \n    ::: {.cell-output .cell-output-display execution_count=46}\n    ```\n    -1.2500624979594477e-9\n    ```\n    :::\n    :::\n    \n    \n    :::\n:::\n\n## Ejercicios propuestos\n\n\n\n:::{#exr-derivadas-funciones-varias-variables-propuesto-1}\n¿Emparejar las siguientes funciones de dos variables con sus diagramas de contorno?\n\n::: {.cell execution_count=47}\n\n::: {.cell-output .cell-output-display execution_count=48}\n![](09-derivadas-funciones-varias-variables_files/figure-pdf/cell-48-output-1.png){}\n:::\n:::\n\n\n::: {.cell hold='true' execution_count=48}\n\n::: {.cell-output .cell-output-display execution_count=49}\n```{=tex}\nEmpareja la función con su gráfica.\n\n$$f(x,y) = \\frac{\\operatorname{sen}(2x^2+y^2)}{\\sqrt{x^2+y^2}}$$\n${\\quad\\Box}$ C\n\n${\\quad\\Box}$ D\n\n${\\quad\\Box}$ B\n\n${\\quad\\Box}$ A\n\n(\\emph{Select an answer})\n\n\n$$h(x,y) = \\cos(x)-\\operatorname{sen}(2y)$$\n${\\quad\\Box}$ C\n\n${\\quad\\Box}$ D\n\n${\\quad\\Box}$ B\n\n${\\quad\\Box}$ A\n\n(\\emph{Select an answer})\n\n\n$$i(x,y) = \\frac{1}{2}(\\operatorname{sen}(x^2)-\\cos(y^2))$$\n${\\quad\\Box}$ C\n\n${\\quad\\Box}$ D\n\n${\\quad\\Box}$ B\n\n${\\quad\\Box}$ A\n\n(\\emph{Select an answer})\n\n\n$$g(x,y) = \\frac{\\cos(xy)}{\\sqrt{x^2+1}}$$\n${\\quad\\Box}$ C\n\n${\\quad\\Box}$ D\n\n${\\quad\\Box}$ B\n\n${\\quad\\Box}$ A\n\n(\\emph{Select an answer})\n\n\n```\n:::\n:::\n\n\n:::\n\n:::{#exr-derivadas-funciones-varias-variables-propuesto-2}\nDada la función \n\n$$\nf(x,y,z)=\\frac{\\ln(\\sqrt{\\cos(x^2y)})}{z^2},\n$$\n\ncalcular $\\dfrac{\\partial^3 f}{\\partial y\\partial z\\partial x}$ en el punto $(2,\\pi,1)$.\n\n::: {.cell execution_count=49}\n\n::: {.cell-output .cell-output-display execution_count=50}\n```{=tex}\n\\vspace{18pt}*Hint: *\n\nIntroducir hasta 5 decimales\n\n```\n:::\n:::\n\n\n:::\n\n:::{#exr-derivadas-funciones-varias-variables-propuesto-3}\nLa velocidad de una reacción química típicamente depende de la temperatura y de la concentración de los reactivos. En una reacción de hidrólisis del acetato de etilo por hidróxido de sodio (NaOH) en una solución acuosa, la velocidad de reacción viene dada por la fórmula $R(t,a,s)=\\frac{t}{3}\\sqrt[3]{a^2s^2}$, donde $t$ es la temperatura de la reacción, $a$ la concentración de acetato de etilo y $s$ la concentración de hidróxido de sodio.\n\na.  ¿En qué dirección debe cambiarse la temperatura y las concentraciones de los reactivos para que la velocidad de reacción aumente lo más rápidamente posible si la temperatura y las concentraciones actuales son the 40ºC, 0.4 mol/l y 0.5 mol/l respectivamente?\n\n\n    ::: {.cell execution_count=50}\n    \n    ::: {.cell-output .cell-output-display execution_count=51}\n    ```{=tex}\n    Dirección de cambio de la temperatura: $\\rule{2.54cm}{0.15mm}$\n    \n    ```\n    :::\n    :::\n    \n    \n\n    ::: {.cell execution_count=51}\n    \n    ::: {.cell-output .cell-output-display execution_count=52}\n    ```{=tex}\n    Dirección de cambio del acetato de etilo: $\\rule{2.54cm}{0.15mm}$\n    \n    ```\n    :::\n    :::\n    \n    \n\n    ::: {.cell execution_count=52}\n    \n    ::: {.cell-output .cell-output-display execution_count=53}\n    ```{=tex}\n    Dirección de cambio del hidróxido de sodio: $\\rule{2.54cm}{0.15mm}$\n    \n    ```\n    :::\n    :::\n    \n    \na.  ¿Cómo cambiará la velocidad de reacción en ese instante si la temperatura disminuye al mismo ritmo que aumenta la concentración del acetato de etilo y la concentración de acetato de etilo aumenta la mitad de lo que aumenta la concentración del hidróxido de sodio?\n\n\n    ::: {.cell execution_count=53}\n    \n    ::: {.cell-output .cell-output-display execution_count=54}\n    ```{=tex}\n    \\vspace{18pt}*Hint: *\n    \n    Introducir hasta 5 decimales\n    \n    ```\n    :::\n    :::\n    \n    \n:::\n\n:::{#exr-derivadas-funciones-varias-variables-propuesto-4}\nLa superficie $\\frac{e^{z\\cos(xy)}}{xz}=\\frac{1}{e}$ define a $z$ como función implícita $z=f(x,y)$.\n\na.  ¿Cuál de las siguientes afirmaciones es cierta?\n\n\n    ::: {.cell execution_count=54}\n    \n    ::: {.cell-output .cell-output-display execution_count=55}\n    ```{=tex}\n    ${\\quad\\Box}$ Las otras opciones son falsas.\n    \n    ${\\quad\\Box}$ La variable $z$ aumenta la mitad de lo que aumenta $x$, si $y$ se mantiene constante.\n    \n    ${\\quad\\Box}$ La variable $z$ se mantiene constante cuando se incrementa $x$, si $y$ se mantiene constante.\n    \n    ${\\quad\\Box}$ La variable $z$ aumenta $1/e$ unidades por cada unidad que aumente $x$, si $y$ se mantiene constante.\n    \n    ${\\quad\\Box}$ La variable $z$ disminuye lo mismo que aumenta $y$, si $x$ se mantiene constante.\n    \n    ```\n    :::\n    :::\n    \n    \na.  ¿Cuál es la ecuación del plano tangente en el punto $(1,\\pi,1)$?\n\n\n    ::: {.cell execution_count=55}\n    \n    ::: {.cell-output .cell-output-display execution_count=56}\n    ```{=tex}\n    ${\\quad\\Box}$ $$z=(\\pi+1)x-y$$\n    ${\\quad\\Box}$ Las otras opciones son falsas.\n    \n    ${\\quad\\Box}$ $$z=\\frac{3-x}{2}$$\n    ${\\quad\\Box}$ $$z=x+y-(\\pi+2)$$\n    ${\\quad\\Box}$ $$z=1-x+\\frac{y}{\\pi}$$\n    ```\n    :::\n    :::\n    \n    \n:::\n\n:::{#exr-derivadas-funciones-varias-variables-propuesto-5}\nDada la función $f(x,y)=-\\dfrac{y}{9+x^2+y^2}$, ¿cuál de las siguientes afirmaciones es cierta?\n\n::: {.cell execution_count=56}\n\n::: {.cell-output .cell-output-display execution_count=57}\n```{=tex}\n${\\quad\\Box}$ Tiene un máximo relativo en el punto $(0,3)$ y un mínimo relativo en el punto $(0,-3)$.\n\n${\\quad\\Box}$ Tiene un máximo relativo en el punto $(0,-3)$ y un mínimo relativo en el punto $(0,3)$.\n\n${\\quad\\Box}$ Tiene un máximo relativo en el punto $(3,-3)$.\n\n${\\quad\\Box}$ Tiene un máximo relativo en el punto $(0,-3)$ y un punto de silla en el punto $(0,3)$.\n\n${\\quad\\Box}$ No tiene extremos relativos.\n\n```\n:::\n:::\n\n\n:::\n\n:::{#exr-derivadas-funciones-varias-variables-propuesto-6}\nCalcular el polinomio de Taylor de segundo grado de la función $f(x,y)=\\operatorname{sen}(x/y)$ en el punto $(\\pi/2,1)$ y utilizarlo para calcular el valor aproximado de $f(1.5,1)$.\n\n::: {.cell execution_count=57}\n\n::: {.cell-output .cell-output-display execution_count=58}\n```{=tex}\n\\vspace{18pt}*Hint: *\n\nIntroducir hasta 8 decimales\n\n```\n:::\n:::\n\n\n:::\n\n",
    "supporting": [
      "09-derivadas-funciones-varias-variables_files/figure-pdf"
    ],
    "filters": []
  }
}