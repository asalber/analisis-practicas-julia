{
  "hash": "f3280e011396f8a14bcf629a7cb08895",
  "result": {
    "engine": "jupyter",
    "markdown": "---\ntitle: Derivadas de funciones reales\nlang: es\n#jupyter: julia-1.10\n---\n\n## Ejercicios Resueltos\n\nPara la realización de esta práctica se requieren los siguientes paquetes:\n\n::: {.cell execution_count=1}\n``` {.julia .cell-code}\nusing SymPy  # Para el cálculo simbólico de límites.\nusing Plots  # Para el dibujo de gráficas.\n#plotlyjs() # Para obtener gráficos interactivos.\nusing ImplicitPlots # Para dibujar curvas implícitas.\nusing MTH229 # Para restringir la gráfica de una función a su dominio.\nusing LaTeXStrings  # Para usar código LaTeX en los gráficos.\nusing Latexify  # Para convertir expresiones a código LaTeX.\n```\n:::\n\n\n:::{#exr-tasa-variacion}\n[Galileo Galilei](https://en.wikipedia.org/wiki/Galileo_Galilei) trató de estudiar el movimiento de un cuerpo en caída libre con un experimento en el que midió la distancia recorrida cada segundo por una bola que caía por un plano inclinado. \n\n![Plano inclinado de Galileo.](img/derivadas/plano-inclinado.png)\n\nLa siguiente tabla recoge sus mediciones.\n\n| Tiempo (s) | Distancia (cm) |\n|:-:|:-:|\n|0 | 0 |\n|1 | 1 |\n|2 | 4 |\n|3 | 9 |\n|4 | 16|\n|5 | 25|\n\na.  Dibujar la gráfica que resulta de unir los puntos correspondientes a los pares de la tabla con segmentos. ¿Qué forma tiene la gráfica?\n\n    :::{.callout-note collapse=\"true\"}\n    ## Ayuda\n    Definir dos arrays con los valores del tiempo y la distancia y usar la función [`scatter`](https://aprendeconalf.es/manual-julia/graficos.html#a%C3%B1adir-puntos-a-una-gr%C3%A1fica) del paquete `Plots`, o bien la función [`scatter`](https://aprendeconalf.es/manual-julia/graficos.html#diagrama-de-puntos) del paquete `Makie`, para dibujar el array de términos.\n    :::\n\n    :::{.callout-tip collapse=\"true\"}\n    ## Solución\n\n    :::{.panel-tabset}\n\n    ## Plots\n\n\n    ::: {.cell execution_count=2}\n    ``` {.julia .cell-code}\n    using Plots\n    t = [0, 1, 2, 3, 4, 5, 6]\n    d = [0, 1, 4, 9, 16, 25, 36]\n    Plots.scatter(t, d, legend=false)\n    plt = Plots.plot!(t, d, linecolor=\"blue\", xlab=\"Tiempo (s)\", ylab=\"Distancia recorrida (cm)\")\n    ```\n    \n    ::: {.cell-output .cell-output-display execution_count=3}\n    ![](05-derivadas_files/figure-pdf/cell-3-output-1.svg){fig-pos='H'}\n    :::\n    :::\n    \n    \n    ## Makie\n\n\n    ::: {.cell execution_count=3}\n    ``` {.julia .cell-code}\n    using GLMakie\n    t = [0, 1, 2, 3, 4, 5, 6]\n    d = [0, 1, 4, 9, 16, 25, 36]\n    fig = Figure()\n    ax = Axis(fig[1,1], xlabel=\"Tiempo (s)\", ylabel=\"Distancia recorrida (cm)\")\n    Makie.scatter!(ax, t, d)\n    f(x) = x^2\n    Makie.lines!(ax, 0..6, f)\n    fig\n    ```\n    \n    ::: {.cell-output .cell-output-display execution_count=4}\n    ![](05-derivadas_files/figure-pdf/cell-4-output-1.png){fig-pos='H'}\n    :::\n    :::\n    \n    \n    :::\n\n    Se aprecia que una forma parabólica.\n    :::\n\na.  Calcular la velocidad media (tasa de variación media) desde los instantes $t=0, 1, 2$ hasta el instante $t=3$ y dibujar la rectas secantes a la gráfica anterior en esos instantes. ¿Cómo es la tendencia de las velocidades medias?\n\n    :::{.callout-note collapse=\"true\"}\n    ## Ayuda\n    La tasa de variación media de una función $f$ en un intervalo $[a,b]$ viene dada por la fórmula\n\n    $$\n    TVM(f,[a,b]) = \\frac{f(b)-f(a)}{b-a},\n    $$\n\n    y la recta secante a la función $f$ en el intervalo $[a,b]$ tiene ecuación\n\n    $$\n    y = f(a) + TVM(f,[a,b]) (x-a).\n    $$\n    :::\n\n    :::{.callout-tip collapse=\"true\"}\n    ## Solución\n\n\n    ::: {.cell execution_count=4}\n    ``` {.julia .cell-code}\n    # Función para el cálculo de la velocidad media en del instante i al instante j.\n    tvm(i, j) = (d[j]-d[i])/(t[j]-t[i])\n    j = 4\n    # Cálculo de las velocidades medias.\n    for i in 1:3\n        println(\"Velocidad media desde el instante $(t[i]) al instante $(t[j]): $(tvm(i, j)) cm/s\")\n    end\n    # Función para calcular la ecuación de la recta secante en los instantes i y j.\n    secante(x, i, j) = d[i] + tvm(i, j) * (x - t[i])\n    # Dibujo de las rectas secantes\n    for i in 1:3\n        plt = Plots.plot!(x -> secante(x,i,j))\n    end\n    plt\n    ```\n    \n    ::: {.cell-output .cell-output-stdout}\n    ```\n    Velocidad media desde el instante 0 al instante 3: 3.0 cm/s\n    Velocidad media desde el instante 1 al instante 3: 4.0 cm/s\n    Velocidad media desde el instante 2 al instante 3: 5.0 cm/s\n    ```\n    :::\n    \n    ::: {.cell-output .cell-output-display execution_count=5}\n    ![](05-derivadas_files/figure-pdf/cell-5-output-2.svg){fig-pos='H'}\n    :::\n    :::\n    \n    \n    Las velocidades medias crecen a medida que pasa el tiempo.\n    :::\n\na.  Calcular la velocidad media desde el instante $t=3$ hasta los instantes $t=6, 5, 4$ y dibujar la rectas secantes a la gráfica anterior en esos instantes. ¿Cómo es la tendencia de las velocidades medias? ¿Hacia dónde tiende la velocidad media cuando los aproximamos al instante $t=3$ con instantes menores y mayores?\n\n    :::{.callout-tip collapse=\"true\"}\n    ## Solución\n\n\n    ::: {.cell execution_count=5}\n    ``` {.julia .cell-code}\n    i = 4\n    # Cálculo de las velocidades medias.\n    for j in 7:-1:5\n        println(\"Velocidad media desde el instante $(t[i]) al instante $(t[j]): $(tvm(i, j)) cm/s\")\n    end\n    # Dibujo de las rectas secantes.\n    for j in 7:-1:5\n        plt = Plots.plot!(x -> secante(x,i,j))\n    end\n    plt\n    ```\n    \n    ::: {.cell-output .cell-output-stdout}\n    ```\n    Velocidad media desde el instante 3 al instante 6: 9.0 cm/s\n    Velocidad media desde el instante 3 al instante 5: 8.0 cm/s\n    Velocidad media desde el instante 3 al instante 4: 7.0 cm/s\n    ```\n    :::\n    \n    ::: {.cell-output .cell-output-display execution_count=6}\n    ![](05-derivadas_files/figure-pdf/cell-6-output-2.svg){fig-pos='H'}\n    :::\n    :::\n    \n    \n    Las velocidades medias decrecen a medida que el tiempo decrece.\n\n    Se puede deducir que las velocidades medias tienden a $6$ cm/s cuando los instantes se aproximan a $3$ s.\n    :::\n\na.  Calcular la variación en la distancia recorrida cada segundo que pasa. ¿Cómo evoluciona la velocidad de la bola? \n\n    :::{.callout-tip collapse=\"true\"}\n    ## Solución\n\n\n    ::: {.cell execution_count=6}\n    ``` {.julia .cell-code}\n    v = []\n    for i in 2:length(d)\n        push!(v, d[i]-d[i-1])\n        println(\"Velocidad media desde el instante $(t[i-1]) al instante $(t[i]): $(v[i-1]) cm/s\")\n    end\n    ```\n    \n    ::: {.cell-output .cell-output-stdout}\n    ```\n    Velocidad media desde el instante 0 al instante 1: 1 cm/s\n    Velocidad media desde el instante 1 al instante 2: 3 cm/s\n    Velocidad media desde el instante 2 al instante 3: 5 cm/s\n    Velocidad media desde el instante 3 al instante 4: 7 cm/s\n    Velocidad media desde el instante 4 al instante 5: 9 cm/s\n    Velocidad media desde el instante 5 al instante 6: 11 cm/s\n    ```\n    :::\n    :::\n    \n    \n    :::\n\na.  Calcular la variación en la velocidad cada segundo que pasa. ¿Cómo evoluciona la aceleración de la bola? ¿Qué conclusiones sacó Galileo sobre la aceleración de la bola?\n\n    :::{.callout-tip collapse=\"true\"}\n    ## Solución\n\n\n    ::: {.cell execution_count=7}\n    ``` {.julia .cell-code}\n    for i in 2:length(v)\n        println(\"Aceleración media desde el instante $(t[i-1]) al instante $(t[i]): $(v[i]-v[i-1]) cm/s\")\n    end\n    ```\n    \n    ::: {.cell-output .cell-output-stdout}\n    ```\n    Aceleración media desde el instante 0 al instante 1: 2 cm/s\n    Aceleración media desde el instante 1 al instante 2: 2 cm/s\n    Aceleración media desde el instante 2 al instante 3: 2 cm/s\n    Aceleración media desde el instante 3 al instante 4: 2 cm/s\n    Aceleración media desde el instante 4 al instante 5: 2 cm/s\n    ```\n    :::\n    :::\n    \n    \n    Se observa que la aceleración es la misma. Galileo concluyó que la aceleración de un cuerpo en caída libre era uniforme.\n    :::\n:::\n\n:::{#exr-derivabilidad}\nRepresentar gráficamente la función $f(x)=|x-1|$ y estudiar su derivabilidad en el punto $x=1$ haciendo uso de la definición de derivada.\n\n:::{.callout-tip collapse=\"true\"}\n## Solución\n\n::: {.cell execution_count=8}\n``` {.julia .cell-code}\nusing Plots, SymPy, LaTeXStrings\n@syms x::real\nf(x) = abs(x-1)\ndisplay(Plots.plot(f(x), label=L\"f(x)=|x-1|\"))\nprintln(\"Derivada por la izquierda: \", limit((f(x)-f(1))/(x-1), x=>1, dir=\"-\"))\nprintln(\"Derivada por la derecha: \", limit((f(x)-f(1))/(x-1), x=>1, dir=\"+\"))\n```\n\n::: {.cell-output .cell-output-display}\n![](05-derivadas_files/figure-pdf/cell-9-output-1.svg){fig-pos='H'}\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\nDerivada por la izquierda: -1\nDerivada por la derecha: 1\n```\n:::\n:::\n\n\nComo la derivada por la izquierda y por la derecha no son iguales, la función no es derivable en $x=1$.\n:::\n:::\n\n:::{#exr-derivadas-sucesivas}\nCalcular las derivadas de las siguientes funciones hasta el orden 4 y deducir la expresión de la derivada de orden $n$.\n\na.  $f(x)=\\ln(x+1)$\n\n    :::{.callout-note collapse=\"true\"}\n    ## Ayuda\n    Usar la función [`diff(f,n)`](https://docs.juliahub.com/SymPy/KzewI/1.0.31/Tutorial/calculus/#Derivatives-1) del paquete `SymPy` para calcular simbólicamente la derivada de grado `n` de la función `f`.\n    :::\n\n    :::{.callout-tip collapse=\"true\"}\n    ## Solución\n\n\n    ::: {.cell execution_count=9}\n    ``` {.julia .cell-code}\n    using SymPy\n    @syms x::real\n    f(x) = log(x+1)\n    println(\"Primera derivada: \", diff(f(x)))\n    println(\"Segunda derivada: \", diff(f(x), x, 2))\n    println(\"Tercera derivada: \", diff(f(x), x, 3))\n    println(\"Cuarta derivada: \", diff(f(x), x, 4))\n    ```\n    \n    ::: {.cell-output .cell-output-stdout}\n    ```\n    Primera derivada: 1/(x + 1)\n    Segunda derivada: -1/(x + 1)^2\n    Tercera derivada: 2/(x + 1)^3\n    Cuarta derivada: -6/(x + 1)^4\n    ```\n    :::\n    :::\n    \n    \n    La derivada de orden $n$ es $f^{(n}=\\frac{(-1)^{n-1}(n-1)!}{(x+1)^n}$.\n    :::\n\na.  $f(x)=a^x$\n\n    :::{.callout-tip collapse=\"true\"}\n    ## Solución\n\n\n    ::: {.cell execution_count=10}\n    ``` {.julia .cell-code}\n    using SymPy\n    @syms x::real a::real\n    g(x) = a^x\n    println(\"Primera derivada: \", diff(g(x), x))\n    println(\"Segunda derivada: \", diff(g(x), x, 2))\n    println(\"Tercera derivada: \", diff(g(x), x, 3))\n    println(\"Cuarta derivada: \", diff(g(x), x, 4))\n    ```\n    \n    ::: {.cell-output .cell-output-stdout}\n    ```\n    Primera derivada: a^x*log(a)\n    Segunda derivada: a^x*log(a)^2\n    Tercera derivada: a^x*log(a)^3\n    Cuarta derivada: a^x*log(a)^4\n    ```\n    :::\n    :::\n    \n    \n    La derivada de orden $n$ es $g^{(n}=a^x\\ln(a)^n$.\n    :::\n\na.  $h(x)=\\operatorname{sen}(x)+\\cos(x)$\n\n    :::{.callout-tip collapse=\"true\"}\n    ## Solución\n\n\n    ::: {.cell execution_count=11}\n    ``` {.julia .cell-code}\n    using SymPy\n    @syms x::real\n    h(x) = sin(x)+cos(x)\n    println(\"Primera derivada: \", diff(h(x)))\n    println(\"Segunda derivada: \", diff(h(x), x, 2))\n    println(\"Tercera derivada: \", diff(h(x), x, 3))\n    println(\"Cuarta derivada: \", diff(h(x), x, 4))\n    ```\n    \n    ::: {.cell-output .cell-output-stdout}\n    ```\n    Primera derivada: -sin(x) + cos(x)\n    Segunda derivada: -(sin(x) + cos(x))\n    Tercera derivada: sin(x) - cos(x)\n    Cuarta derivada: sin(x) + cos(x)\n    ```\n    :::\n    :::\n    \n    \n    La derivada de orden $n$ es \n\n    $$\n    h^{(n}=\n    \\begin{cases}\n    \\operatorname{sen}(x)+\\cos(x) & \\mbox{si } n=4k\\\\\n    \\cos(x)-\\operatorname{sen}(x) & \\mbox{si } n=4k+1\\\\\n    -\\operatorname{sen}(x)-\\cos(x) & \\mbox{si } n=4k+2\\\\\n    -\\cos(x)+\\operatorname{sen}(x) & \\mbox{si } n=4k+3\\\\\n    \\end{cases}\n    \\quad k\\in\\mathbb{N}\n    $$\n    :::\n:::\n\n:::{#exr-secantes-tangente}\nSea $f(x)=\\sqrt{x}$.\n\na.  Dibujar la gráfica de $f$ y dibujar las rectas secantes a $f$ en los intervalos $[\\frac{i}{10}, 1]$ para $i=0,\\ldots, 9$. ¿Hacia dónde tienden las pendientes de las rectas secantes?\n\n    :::{.callout-tip collapse=\"true\"}\n    ## Solución\n\n\n    ::: {.cell execution_count=12}\n    ``` {.julia .cell-code}\n    using Plots, SymPy, LaTeXStrings, Latexify\n    @syms x::real\n    f(x) = sqrt(x)\n    plt = Plots.plot(f, 0, 2, ylims=(0,2.5), linewidth = 3, label=L\"f(x)=\\sqrt{x}\", legend=:topleft)\n    secante(x, i, j) = f(i) + (f(j)-f(i))/(j-i) * (x - i)\n    for i in 0:9\n        sec = secante(x, i/10, 1)\n        plt = Plots.plot!(sec, label =L\"y=\" * latexify(sec))\n    end\n    plt\n    ```\n    \n    ::: {.cell-output .cell-output-display execution_count=13}\n    ![](05-derivadas_files/figure-pdf/cell-13-output-1.svg){fig-pos='H'}\n    :::\n    :::\n    \n    \n    Se deduce que las pendientes de las rectas secantes tienen a $0.5$.\n    :::\n\na.  Dibujar la recta tangente a la gráfica de $f$ en $x=1$. \n\n    :::{.callout-note collapse=\"true\"}\n    ## Ayuda\n    La ecuación de la recta tangente a la función $f(x)$ en el punto $a$ es $y=f(a)+f'(a)(x-a)$.\n\n    Usar la función [`diff(f)`](https://docs.juliahub.com/SymPy/KzewI/1.0.31/Tutorial/calculus/#Derivatives-1) del paquete `SymPy` para calcular simbólicamente la derivada de la función `f`.\n    :::\n\n    :::{.callout-tip collapse=\"true\"}\n    ## Solución\n\n\n    ::: {.cell execution_count=13}\n    ``` {.julia .cell-code}\n    tg = f(1) + diff(f(x))(1) * (x-1)\n    Plots.plot!(tg, linewidth = 2, color = \"red\", label=\"Tangente \" * L\"y=\" * latexify(tg))\n    ```\n    \n    ::: {.cell-output .cell-output-display execution_count=14}\n    ![](05-derivadas_files/figure-pdf/cell-14-output-1.svg){fig-pos='H'}\n    :::\n    :::\n    \n    \n    :::\n:::\n\n:::{#exr-tangente-normal}\nCalcular y dibujar las rectas tangente y normal a la gráfica de la función $f(x)=\\ln(\\sqrt{x+1})$ en $x=1$.\n\n:::{.callout-note collapse=\"true\"}\n## Ayuda\nLa ecuación de la recta tangente a una función $f$ en el punto $a$ es \n\n$$\ny = f(a) + f'(a)(x-a),\n$$\n\ny la de la recta normal\n\n$$\ny = f(a)-\\frac{1}{f'(a)}(x-a).\n$$\n:::\n\n:::{.callout-tip collapse=\"true\"}\n## Solución\n\n::: {.cell execution_count=14}\n``` {.julia .cell-code}\nusing Plots, SymPy, LaTeXStrings, Latexify\n@syms x::real\nf(x) = log(sqrt(x+1))\nPlots.plot(f, -1, 3, xlims=(-1,3), ylims=(-1,2), aspect_ratio=1, label=L\"f(x)=\\ln(\\sqrt{x+1})\", legend=:topright)\ntg = f(1) + diff(f(x))(1) * (x-1)\nPlots.plot!(tg, label=\"Tangente \"*L\"y=\"*latexify(tg))\nnm = f(1) - 1/diff(f(x))(1) * (x-1)\nPlots.plot!(nm, label=\"Normal \"*L\"y=\"*latexify(nm))\n```\n\n::: {.cell-output .cell-output-display execution_count=15}\n![](05-derivadas_files/figure-pdf/cell-15-output-1.svg){fig-pos='H'}\n:::\n:::\n\n\n:::\n:::\n\n:::{#exr-crecimiento-extremos-concavidad}\nSea la función $g(x)=\\dfrac{2x^3-3x}{x^2+1}$.\n\na.  Dibujar la gráfica de $g$.\n\n    :::{.callout-tip collapse=\"true\"}\n    ## Solución\n\n\n    ::: {.cell execution_count=15}\n    ``` {.julia .cell-code}\n    using Plots, SymPy, LaTeXStrings, Latexify\n    @syms x::real\n    g(x) = (2x^3-3x) / (x^2+1)\n    Plots.plot(g, -2, 2, label=L\"g(x)=\\frac{2x^3-3x}{x^2+1}\", legend=:topleft)\n    ```\n    \n    ::: {.cell-output .cell-output-display execution_count=16}\n    ![](05-derivadas_files/figure-pdf/cell-16-output-1.svg){fig-pos='H'}\n    :::\n    :::\n    \n    \n    :::\n\na.  Calcular la derivada de $g$ y dibujar su gráfica en la misma gráfica que la de $g$.\n\n    :::{.callout-tip collapse=\"true\"}\n    ## Solución\n\n\n    ::: {.cell execution_count=16}\n    ``` {.julia .cell-code}\n    Plots.plot!(diff(g(x)), label=L\"g'(x)=\"*latexify(simplify(diff(g(x)))))\n    ```\n    \n    ::: {.cell-output .cell-output-display execution_count=17}\n    ![](05-derivadas_files/figure-pdf/cell-17-output-1.svg){fig-pos='H'}\n    :::\n    :::\n    \n    \n    :::\n\na.  Calcular los puntos críticos de $g$.\n\n    :::{.callout-note collapse=\"true\"}\n    ## Ayuda\n    Los puntos críticos de una función son los puntos donde se anula la derivada.\n    :::\n\n    :::{.callout-tip collapse=\"true\"}\n    ## Solución\n\n\n    ::: {.cell execution_count=17}\n    ``` {.julia .cell-code}\n    N.(solve(diff(g(x))))\n    ```\n    \n    ::: {.cell-output .cell-output-display execution_count=18}\n    ```\n    2-element Vector{Float64}:\n     -0.5583347485961263\n      0.5583347485961263\n    ```\n    :::\n    :::\n    \n    \n    Existen dos puntos críticos en $x=-0.55$ y $x=0.55$ aproximadamente.\n    :::\n\na.  A la vista de los puntos críticos y de la gráfica de la función derivada, determinar los intervalos de crecimiento y los extremos relativos de la función.\n\n    :::{.callout-note collapse=\"true\"}\n    ## Ayuda\n    Una función $f$ derivable en el punto $a$ es creciente si y solo si $f'(a)>0$ y decrecientes si y solo si $f'(a)<0$.\n    :::\n\n    :::{.callout-tip collapse=\"true\"}\n    ## Solución\n    La derivada es positiva en los intervalos $(-\\infty,-0.55)$ y $(0.55,\\infty)$, por lo que la función $g$ es creciente en estos intervalos, y la derivada es negativa en el intervalo $(-0.55, 0.55)$, por lo que la función $g$ es decreciente en este intervalo.\n\n    En el punto crítico $x=-0.55$ la derivada es positiva a la izquierda y negativa a la derecha, por lo que, según el criterio de la primera derivada, la función $g$ tiene un máximo relativo.\n\n    En el punto crítico $x=0.55$ la derivada es negativa a la izquierda y positiva a la derecha, por lo que, según el criterio de la primera derivada, la función $g$ tiene un mínimo relativo.\n    :::\n\na.  Calcular segunda la derivada de $g$ y dibujar su gráfica en la misma gráfica que la de $g$.\n\n    :::{.callout-tip collapse=\"true\"}\n    ## Solución\n\n\n    ::: {.cell execution_count=18}\n    ``` {.julia .cell-code}\n    Plots.plot!(diff(g(x), x, 2), label=L\"g''(x)=\"*latexify(simplify(diff(g(x), x, 2))))\n    ```\n    \n    ::: {.cell-output .cell-output-display execution_count=19}\n    ![](05-derivadas_files/figure-pdf/cell-19-output-1.svg){fig-pos='H'}\n    :::\n    :::\n    \n    \n    :::\n\na.  Calcular los puntos que anulan la segunda derivada de $g$.\n\n    :::{.callout-tip collapse=\"true\"}\n    ## Solución\n\n\n    ::: {.cell execution_count=19}\n    ``` {.julia .cell-code}\n    N.(solve(diff(g(x), x, 2)))\n    ```\n    \n    ::: {.cell-output .cell-output-display execution_count=20}\n    ```\n    3-element Vector{Real}:\n      0\n     -1.7320508075688772\n      1.7320508075688772\n    ```\n    :::\n    :::\n    \n    \n    Existen tres puntos donde se anula $g''(x)$, en $x=-1.73$, $x=0$ y $x=1.73$ aproximadamente.\n    :::\n\na.  A la vista de las raíces de la gráfica de la segunda derivada, determinar los intervalos de concavidad y los puntos de inflexión de la función $g$.\n\n    :::{.callout-note collapse=\"true\"}\n    ## Ayuda\n    Una función $f$ dos veces derivable en el punto $a$ es cóncava hacia arriba si y solo si $f''(a)>0$ y cóncava hacia abajo si y solo si $f''(a)<0$. Los puntos de inflexión de una función son los puntos donde cambia la concavidad. \n    :::\n\n    :::{.callout-tip collapse=\"true\"}\n    ## Solución\n    La segunda derivada es positiva en los intervalos $(-\\infty,-1,73)$ y $(0,1.73)$, por lo que la función $g$ es cóncava hacia arriba en esos intervalos, y la segunda derivada es negativa en los intervalos $(-1.73,0)$ y $(1.73,\\infty)$, por lo que la función $g$ es cóncava hacia abajo en esos intervalos.\n\n    $g$ tiene tres puntos de inflexión en $x=1.73$, $x=0$ y $x=1.73$, donde cambia la concavidad de la función.\n    :::\n:::\n\n:::{#exr-tangente-implicita}\nConsidérese la curva con ecuación $x^4 - 3x^2 + 2y^2=0$. \n\na.  Dibujar la gráfica de la curva.\n\n    :::{.callout-note collapse=\"true\"}\n    ## Ayuda\n    Para dibujar curvas implícitas utilizar la función `implicit_plot` del paquete [`ImplicitPlots`](https://juliapackages.com/p/implicitplots).\n    :::\n\n    :::{.callout-tip collapse=\"true\"}\n    ## Solución\n\n\n    ::: {.cell execution_count=20}\n    ``` {.julia .cell-code}\n    using ImplicitPlots, Plots, SymPy, LaTeXStrings, Latexify\n    @syms x::real y::real\n    f(x,y) = x^4 - 3x^2 + 2y^2\n    implicit_plot(f; xlims=(-3,3), ylims=(-1.5,1.5), label=L\"x^4-3x^2+2y^2=0\", legend=:topleft)\n    ```\n    \n    ::: {.cell-output .cell-output-display execution_count=21}\n    ![](05-derivadas_files/figure-pdf/cell-21-output-1.svg){fig-pos='H'}\n    :::\n    :::\n    \n    \n    :::\n\na.  Calcular la tasa de variación de $y$ con respecto a $x$ en el punto $(1,1)$.\n\n    :::{.callout-note collapse=\"true\"}\n    ## Ayuda\n    Para realizar derivadas implícitas simbólicamente hay que definir una función simbólica con el comando `@syms u()` del paquete `SymPy` y reemplazar `y` por `u(x)` en la ecuación de la curva implícita.\n\n    Después hay que hacer la derivada de ambos lados de la ecuación y finalmente hay que resolver la ecuación despejando la derivada de `u(x)`.\n    :::\n\n    :::{.callout-tip collapse=\"true\"}\n    ## Solución\n\n\n    ::: {.cell execution_count=21}\n    ``` {.julia .cell-code}\n    # Declaramos una función simbólica\n    @syms u()\n    # Reemplazamos y por una función simbólica u(x).\n    ex1 = subs(f(x,y), y=>u(x))\n    # Calculamos la derivada de ambos lados de la ecuación y la resolvemos para la derivada de u'(x).\n    du = solve(diff(ex1, x), diff(u(x), x))[1]\n    # Deshacemos el cambio y = u(x).\n    dy = subs(du, u(x) => y)\n    println(\"y'=\", dy)\n    ```\n    \n    ::: {.cell-output .cell-output-stdout}\n    ```\n    y'=x*(3 - 2*x^2)/(2*y)\n    ```\n    :::\n    :::\n    \n    \n    :::\n\na.  Dibujar la recta tangente a la curva anterior en el punto $(1,1)$.\n\n    :::{.callout-tip collapse=\"true\"}\n    ## Solución\n\n\n    ::: {.cell execution_count=22}\n    ``` {.julia .cell-code}\n    using Latexify\n    # Definimos la funciónd de la recta tangente\n    tg = 1 + dy(1,1) * (x-1)\n    Plots.plot!(tg, label=\"Tangente \"*L\"y=\"*latexify(tg))\n    # Dibujamos el punto (1,1)\n    Plots.scatter!([1],[1], label=\"\")\n    ```\n    \n    ::: {.cell-output .cell-output-display execution_count=23}\n    ![](05-derivadas_files/figure-pdf/cell-23-output-1.svg){fig-pos='H'}\n    :::\n    :::\n    \n    \n    :::\n:::\n\n:::{#exr-taylor-1}\nCrear una función para calcular el polinomio de Taylor de grado $n$ una función $f$ en un punto $a$ y utilizarla para dibujar los polinomios de Taylor de la función $f(x)=\\operatorname{sen}(x)$ en $a=0$ hasta el grado $5$.\n\n:::{.callout-note collapse=\"true\"}\n## Ayuda\nLa fórmula del polinomio de Taylor de grado $n$ de la función $f$ en el punto $a$ es \n\n$$\nP^n_{f,a}(x) = f(a)+f'(a)(x-a)+\\frac{f''(a)}{2!}(x-a)^2+ \\cdots + \\frac{f^{(n}(a)}{n!}(x-a)^n.\n$$\n:::\n\n:::{.callout-tip collapse=\"true\"}\n## Solución\n\n::: {.cell execution_count=23}\n``` {.julia .cell-code}\nusing Plots, SymPy, LaTeXStrings, Latexify\n@syms x::real\n\nfunction taylor(f, a=0, n=2)\n    sum(diff(f, x, i)(a) / factorial(i) * (x-a)^i for i=0:n)\nend\n\nf(x) = sin(x)\nplt = Plots.plot(f, ylims=(-2,2), linewidth=3, label=L\"f(x)=\\operatorname{sen}(x)\")\n\nfor i in 1:5\n    pol = taylor(f(x), 0, i)\n    plt = Plots.plot!(pol, label=latexstring(\"P^{$(i)}(x)=$(pol)\"))\nend \nplt\n```\n\n::: {.cell-output .cell-output-display execution_count=24}\n![](05-derivadas_files/figure-pdf/cell-24-output-1.svg){fig-pos='H'}\n:::\n:::\n\n\n:::\n:::\n\n:::{#exr-taylor-2}\nCalcular los polinomios de Taylor hasta grado 10 de las siguientes funciones en los puntos indicados.\n\na.  $f(x)=\\cos(x)$ en $x=\\pi/2$.\n\n    :::{.callout-note collapse=\"true\"}\n    ## Ayuda\n    Para calcular polinomios de Taylor utilizar la función [`series`](https://docs.juliahub.com/SymPy/KzewI/1.0.29/introduction/#Taylor-series-1) del paquete `SymPy`.\n\n    :::{.callout-warning}\n    La función `series` da el polinomio de grado $n-1$ junto con el error de orden $n$, por lo que si se quiere un polinomio de orden $n$ hay que llamar a la función con un orden $n+1$. \n    :::\n    :::\n\n    :::{.callout-tip collapse=\"true\"}\n    ## Solución\n\n\n    ::: {.cell execution_count=24}\n    ``` {.julia .cell-code}\n    using SymPy\n    @syms x::real\n    f(x) = cos(x)\n    SymPy.series(f(x), x, Sym(pi)/2, 11)\n    ```\n    \n    ::: {.cell-output .cell-output-display execution_count=25}\n    ```{=tex}\n    $\\frac{\\pi}{2} + \\frac{\\left(x - \\frac{\\pi}{2}\\right)^{3}}{6} - \\frac{\\left(x - \\frac{\\pi}{2}\\right)^{5}}{120} + \\frac{\\left(x - \\frac{\\pi}{2}\\right)^{7}}{5040} - \\frac{\\left(x - \\frac{\\pi}{2}\\right)^{9}}{362880} - x + O\\left(\\left(x - \\frac{\\pi}{2}\\right)^{11}; x\\rightarrow \\frac{\\pi}{2}\\right)$\n    ```\n    :::\n    :::\n    \n    \n    :::\n\na.  $g(x)=\\ln(x)$ en $x=1$\n\n    :::{.callout-tip collapse=\"true\"}\n    ## Solución\n\n\n    ::: {.cell execution_count=25}\n    ``` {.julia .cell-code}\n    g(x) = log(x)\n    SymPy.series(g(x), x, 1, 10)\n    ```\n    \n    ::: {.cell-output .cell-output-display execution_count=26}\n    ```{=tex}\n    $-1 - \\frac{\\left(x - 1\\right)^{2}}{2} + \\frac{\\left(x - 1\\right)^{3}}{3} - \\frac{\\left(x - 1\\right)^{4}}{4} + \\frac{\\left(x - 1\\right)^{5}}{5} - \\frac{\\left(x - 1\\right)^{6}}{6} + \\frac{\\left(x - 1\\right)^{7}}{7} - \\frac{\\left(x - 1\\right)^{8}}{8} + \\frac{\\left(x - 1\\right)^{9}}{9} + x + O\\left(\\left(x - 1\\right)^{10}; x\\rightarrow 1\\right)$\n    ```\n    :::\n    :::\n    \n    \n    :::\n\n    a.  $h(x)=e^{\\operatorname{sen}(x)}$ en $x=0$\n\n    :::{.callout-tip collapse=\"true\"}\n    ## Solución\n\n\n    ::: {.cell execution_count=26}\n    ``` {.julia .cell-code}\n    h(x) = exp(sin(x))\n    SymPy.series(h(x), x, 0, 10)\n    ```\n    \n    ::: {.cell-output .cell-output-display execution_count=27}\n    ```{=tex}\n    $1 + x + \\frac{x^{2}}{2} - \\frac{x^{4}}{8} - \\frac{x^{5}}{15} - \\frac{x^{6}}{240} + \\frac{x^{7}}{90} + \\frac{31 x^{8}}{5760} + \\frac{x^{9}}{5670} + O\\left(x^{10}\\right)$\n    ```\n    :::\n    :::\n    \n    \n    :::\n:::\n\n:::{#exr-taylor-3}\nAproximar el número $\\ln(1.2)$ mediante un polinomio de Taylor de grado 8 y dar una cota del error cometido. ¿Hasta qué grado habría que llegar para obtener un error menor de $10^{-10}$?\n\n:::{.callout-note collapse=\"true\"}\n## Ayuda\nEl error en la aproximación de una función $f(b)$ mediante un polinomio de Taylor de grado $n$ en el punto $a$ viene dado por el resto de Taylor, que en la forma de Lagrange es \n\n$$\nR^n_{f,a}(x) = \\frac{f^{(n+1}(x)}{(n+1)!}(x-a)^{n+1}\\mbox{ con } x\\in[a,b].\n$$\n:::\n\n:::{.callout-tip collapse=\"true\"}\n## Solución\nUtilizaremos un polinomio de MacLaurin de grado 5 para la función $f(x)=\\ln(1+x)$.\n\n::: {.cell execution_count=27}\n``` {.julia .cell-code}\nusing SymPy\n@syms x::real\nf(x) = log(1+x)\npol = SymPy.series(f(x), x, 0, 6).removeO()\nprintln(\"Aproximación de ln(1.2): \", N(pol(0.2)))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nAproximación de ln(1.2): 0.18233066666666667\n```\n:::\n:::\n\n\nPara dar una cota del error cometido calculamos el resto de Taylor en la forma de Lagrange.\n\n::: {.cell execution_count=28}\n``` {.julia .cell-code}\nresto = diff(f(x), x, 6) / factorial(6) * 0.2^6\nprintln(\"Resto de Taylor de orden 6: \", resto)\nprintln(\"Derivada del resto : \", diff(resto))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nResto de Taylor de orden 6: -1.06666666666667e-5/(x + 1)^6\nDerivada del resto : 6.4e-5/(x + 1)^7\n```\n:::\n:::\n\n\nComo la derivada no se anula en el intervalo $[1,2]$, no hay extremos relativos, y al ser una función continua en un intervalo cerrado, alcanza el máximo y mínimos absolutos en los extremos.\n\n::: {.cell execution_count=29}\n``` {.julia .cell-code}\nprintln(\"Cota del error: \" , maximum(N(abs.([resto(0), resto(0.2)])))) \nprintln(\"Error: \", abs(log(1.2)-pol(0.2)))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nCota del error: 1.06666666666667e-5\nError: 9.10987271207642e-6\n```\n:::\n:::\n\n\nAsí pues, el error en la aproximación de $\\ln(1.2)$ es menor que $1.06\\cdot 10^{-5}$.\n\nPara ver la fórmula general del resto de Taylor en la forma de Lagrange para un polinomio de Taylor de orden $n$, calculamos las primeras derivadas sucesivas.\n\n::: {.cell execution_count=30}\n``` {.julia .cell-code}\nprintln(\"Primera derivada: \", diff(f(x)))\nprintln(\"Segunda derivada: \", diff(f(x), x, 2))\nprintln(\"Tercera derivada: \", diff(f(x), x, 3))\nprintln(\"Cuarta derivada: \", diff(f(x), x, 4))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nPrimera derivada: 1/(x + 1)\nSegunda derivada: -1/(x + 1)^2\nTercera derivada: 2/(x + 1)^3\nCuarta derivada: -6/(x + 1)^4\n```\n:::\n:::\n\n\nAsí pues, se deduce que la derivada de orden $n$ es $f^{(n}(x)=(-1)^{n-1}\\frac{(n-1)!}{(x+1)^n}$, de manera que el resto de Taylor de orden $n$ es \n\n$$\n|R^n_{f,0}(x)| = \\left|(-1)^{n-1}\\frac{(n-1)!}{(n+1)!(x+1)^n}0.2^{n+1}\\right| = \\left|\\frac{0.2^{n+1}}{(n+1)n(x+1)^n}\\right|\\ x\\in [0,0.2].\n$$\n\nComo se trata de una función positiva y decreciente en el intervalo $[0,0.2]$, alcanza el máximo absoluto en el extremo inferior del intervalo, es decir, en $x=0$, y por tanto se tiene,\n\n$$\n|R^n_{f,1}(x)| \\leq \\left|\\frac{0.2^{n+1}}{(n+1)n}\\right|.\n$$\n\nFinalmente calculamos el primer número natural $n$ tal que $|R^n_{f,1}(x)|<10^{-10}$.\n\n::: {.cell execution_count=31}\n``` {.julia .cell-code}\nn=6\nwhile 0.2^(n+1) / (n*(n+1)) > 10^-10\n    n += 1\nend\nprint(n)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n11\n```\n:::\n:::\n\n\nAsí pues, habría que llegar al grado 11.\n:::\n:::\n\n## Ejercicios propuestos\n\n\n\n:::{#exr-derivabilidad}\nDada la función\n\n$$\nf(x)=\n\\begin{cases}\n\\operatorname{sen}(x)^2 & \\mbox{si $x\\leq 0$},  \\\\\nax^2+b &  \\mbox{si $0<x\\leq c$},  \\\\\n\\ln(x) &  \\mbox{si $c<x$},\n\\end{cases}\n$$\n\n¿Para qué valores de $a$, $b$ y $c$ la función es derivable en todo $\\mathbb{R}$?\n\n::: {.cell execution_count=33}\n\n::: {.cell-output .cell-output-display execution_count=34}\n```{=tex}\n${\\quad\\Box}$ $$a=1, b=0, c=e.$$\n${\\quad\\Box}$ $$a=1, b=1, c=1.$$\n${\\quad\\Box}$ $$a=\\sqrt{e}, b=0, c=\\frac{1}{e}.$$\n${\\quad\\Box}$ $$a=\\frac{1}{2e}, b=0, c=e^{1/2}.$$\n${\\quad\\Box}$ Para ningún valor.\n\n```\n:::\n:::\n\n\n:::\n\n:::{#exr-derivadas-sucesivas-2}\n¿Cuál es la derivada de orden $n$ de la función $f(x)=\\dfrac{1}{\\sqrt{x+1}}$?\n\n::: {.cell execution_count=34}\n\n::: {.cell-output .cell-output-display execution_count=35}\n```{=tex}\n${\\quad\\Box}$ $$\\frac{(-1)^n \\prod_{i=1}^n 2i+1}{2^n}(x+1)^{-(2n+1)/2}.$$\n${\\quad\\Box}$ $$\\frac{(-1)^n \\prod_{i=1}^n 2i-1}{2^n}(x+1)^{-(2n+1)/2}.$$\n${\\quad\\Box}$ $$\\frac{(-1)^n \\prod_{i=1}^n 2i}{2^n}(x+1)^{-(2n+1)/2}.$$\n${\\quad\\Box}$ $$\\frac{(-1)^n (2n-1)!}{2^n}(x+1)^{-(2n-1)/2}.$$\n${\\quad\\Box}$ $$\\frac{(-1)^n n!}{2^n}(x+1)^{-n/2}.$$\n```\n:::\n:::\n\n\n:::\n\n:::{#exr-pendientes-tangentes}\nDadas las funciones $f(x)=\\ln\\left(\\sqrt{\\dfrac{x^2}{2}}\\right)$ y $g(x)=x^3+1$, ¿en qué puntos la recta normal a $f$ y\nla recta tangente a $g$ con paralelas?\n\n::: {.cell execution_count=35}\n\n::: {.cell-output .cell-output-display execution_count=36}\n```{=tex}\n\\vspace{18pt}\n```\n:::\n:::\n\n\n:::\n\n:::{#exr-extremos-absolutos}\nCalcular el máximo y el mínimo absoluto de la función $g(x)=\\sqrt{x^4-3x^3+\\frac{5}{2}x^2}$ en el intervalo $[-0.5,1.5]$.\n\na.  Mínimo absoluto\n\n\n    ::: {.cell execution_count=36}\n    \n    ::: {.cell-output .cell-output-display execution_count=37}\n    ```{=tex}\n    \\vspace{18pt}\n    ```\n    :::\n    :::\n    \n    \na.  Máximo absoluto\n\n\n    ::: {.cell execution_count=37}\n    \n    ::: {.cell-output .cell-output-display execution_count=38}\n    ```{=tex}\n    \\vspace{18pt}\n    ```\n    :::\n    :::\n    \n    \n:::\n\n\n:::{#exr-extremos-puntos-inflexion}\n¿Cuáles de las siguientes afirmaciones son ciertas sobre la función $h(x)=\\dfrac{x^2+1}{e^x}$?\n\n::: {.cell execution_count=38}\n\n::: {.cell-output .cell-output-display execution_count=39}\n```{=tex}\n${\\quad\\Box}$ Tiene un punto de inflexión en $x=3$.\n\n${\\quad\\Box}$ Es cóncava hacia abajo en $(1,3)$.\n\n${\\quad\\Box}$ Tiene un mínimo en $x=1$.\n\n${\\quad\\Box}$ Tiene un máximo en $x=1$.\n\n${\\quad\\Box}$ Es decreciente en todo $\\mathbb{R}$.\n\n(\\emph{Select one or more})\n\n\n```\n:::\n:::\n\n\n:::\n\n:::{#exr-optimizacion-cuerda-anillo}\nUna cuerda de longitud $l$ está sujeta en sus extremos en los puntos $(0,0)$ y $(a,b)$. De la cuerda cuelga un anillo. ¿En qué posición estará el anillo debido a la fuerza de gravedad suponiendo que $l=10$, $a=3$ y $b=2$?\n\n:::{.callout-note collapse=\"true\"}\n## Ayuda\nPuesto que la longitud de la cuerda es fija, del siguiente diagrama se deduce que las las posiciones $(x,y)$ que puede ocupar el anillo vienen dadas por la ecuación \n\n$$\nl = \\sqrt{x^2 + y^2} + \\sqrt{(a-x)^2 + (b-y)^2}\n$$\n\n![Descomposición en triángulos rectángulos de la posición que ocupa un anillo suspendido de una cuerda de tamaño $l$ sujeta en sus extremos en los puntos $(0,0)$ y $(a,b)$.](./img/derivadas/anillo-cuerda.png)\n:::\n\n::::{.columns}\n:::{.column}\nCoordenada x\n\n::: {.cell execution_count=39}\n\n::: {.cell-output .cell-output-display execution_count=40}\n```{=tex}\n\\vspace{18pt}\n```\n:::\n:::\n\n\n:::\n\n:::{.column}\nCoordenada y\n\n::: {.cell execution_count=40}\n\n::: {.cell-output .cell-output-display execution_count=41}\n```{=tex}\n\\vspace{18pt}\n```\n:::\n:::\n\n\n:::\n:::\n:::\n\n:::{#exr-aproximacion-taylor}\nCalcular de manera aproximada el valor de $\\operatorname{sen}(1/2)$ usando los siguientes polinomios de Taylor de la función $f(x)=\\operatorname{sen}(x)$.\n\na.  Polinomio de Taylor de grado 20 en el punto $\\pi/6$.\n\n\n    ::: {.cell execution_count=41}\n    \n    ::: {.cell-output .cell-output-display execution_count=42}\n    ```{=tex}\n    \\vspace{18pt}\n    ```\n    :::\n    :::\n    \n    \na.  Polinomio de MacLaurin de grado 100.\n\n\n    ::: {.cell execution_count=42}\n    \n    ::: {.cell-output .cell-output-display execution_count=43}\n    ```{=tex}\n    \\vspace{18pt}\n    ```\n    :::\n    :::\n    \n    \n:::\n\na.  ¿Qué polinomio da una mejor aproximación?\n\n\n    ::: {.cell execution_count=43}\n    \n    ::: {.cell-output .cell-output-display execution_count=44}\n    ```{=tex}\n    ${\\quad\\Box}$ El polinomio de MacLaurin de grado 100.\n    \n    ${\\quad\\Box}$ El polinomio de Taylor de grado 20 en $\\pi/6$.\n    \n    ```\n    :::\n    :::\n    \n    \n",
    "supporting": [
      "05-derivadas_files/figure-pdf"
    ],
    "filters": []
  }
}