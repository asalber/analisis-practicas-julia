{
  "hash": "87a94dd19059f827cdb1a15f192e0a03",
  "result": {
    "markdown": "# Concepto de derivada\n\n## Ejercicios Resueltos\n\nPara la realización de esta práctica se requieren los siguientes paquetes:\n\n::: {.cell execution_count=1}\n``` {.julia .cell-code}\nusing SymPy  # Para el cálculo simbólico de límites y derivadas\nusing Plots  # Para el dibujo de gráficas\nusing LaTeXStrings  # Para usar código LaTeX en los gráficos.\n```\n:::\n\n\n### Ejercicio 1 {.unnumbered}\n\nCalcular la tasa de variación media de las siguientes funciones en los intervalos $[1, 2]$, $[1, 1.5]$, $[1, 1.1]$, $[1, 1.001]$. ¿Depende la tasa de variación media del intervalo?\n\na. $f(x) = 3x$.\n\n:::{.callout-note collapse=\"true\"}\n## Pista\nLa tasa de variación media de una función $y = f(x)$ en un intervalo $[a,b]$ se define como\n\n\n$$\\mbox{TVM}f(a,b) = \\frac{\\Delta y}{\\Delta x} = \\frac{f(b)-f(a)}{b-a}$$\n\n:::\n\n:::{.callout-tip collapse=\"true\"}\n## Solución\n\n::: {.cell execution_count=2}\n``` {.julia .cell-code}\n# Creamos una función para calcular la tasa de variación media\ntvm(f, a, b) = (f(b) - f(a)) / (b - a)\n# Creamos la función f\nf(x) = 3x\n# Calculamos la tasa de variación media de f en cada intervalo dado\nprintln(tvm(f, 1, 2))\nprintln(tvm(f, 1, 1.5))\nprintln(tvm(f, 1, 1.1))\nprintln(tvm(f, 1, 1.001))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n3.0\n3.0\n3.0\n3.0\n```\n:::\n:::\n\n\nLa tasa de variación media es constante y no depende del intervalo.\n:::\n\nb. $g(x) = x^2$.\n\n:::{.callout-tip collapse=\"true\"}\n## Solución\n\n::: {.cell execution_count=3}\n``` {.julia .cell-code}\n# Creamos la función f\ng(x) = x ^ 2\n# Calculamos la tasa de variación media de f en cada intervalo dado\nprintln(tvm(g, 1, 2))\nprintln(tvm(g, 1, 1.5))\nprintln(tvm(g, 1, 1.1))\nprintln(tvm(g, 1, 1.001))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n3.0\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n2.5\n2.1\n2.0009999999999177\n```\n:::\n:::\n\n\nLa tasa de variación media depende del intervalo.\n:::\n\n### Ejercicio 2 {.unnumbered}\n\nDibujar las gráficas de las siguientes funciones y las rectas secantes a ellas en los intervalos $[1, 2]$, $[1, 1.5]$, $[1, 1.1]$, $[1, 1.001]$.\n\na. $f(x) = 3x$.\n\n:::{.callout-note collapse=\"true\"}\n## Pista\nLa pendiente de la recta secante a una función $f(x)$ en el intervalo $[a, b]$ es la tasa de variación media de $f$ en ese intervalo. Así pues, la ecuación de la recta secante a una función $f(x)$ en el intervalo $[a, b]$ es \n\n\n$$y = f(a) + \\mbox{TVM}f(a,b) (x-a) = f(a) + \\frac{f(b)-f(a)}{b-a}(x-a)$$\n\n:::\n\n:::{.callout-tip collapse=\"true\"}\n## Solución\n\n::: {.cell execution_count=4}\n``` {.julia .cell-code}\n# Creamos una función para calcular la ecuación de la recta secante.\nsecante(f, a, b) = x -> f(a) + (f(b) - f(a)) / (b - a) * (x - a)\n# Definimos la función\nf(x) = 3x\n# Construimos las secantes\ns1 = secante(f, 1, 2)\ns2 = secante(f, 1, 1.5)\ns3 = secante(f, 1, 1.1)\ns4 = secante(f, 1, 1.001)\n# Dibujamos las gráficas de la función y las secantes\nplot(f, 0.5, 2.5, label = L\"f(x)\", linewidth = 2)\nplot([s1, s2, s3, s4], 0.5, 2.5, label = [\"Secante [1, 2]\" \"Secante [1, 1.5]\" \"Secante [1, 1.1]\" \"Secante [1, 1.001]\"])\n```\n\n::: {.cell-output .cell-output-display execution_count=106}\n![](concepto-derivada_files/figure-html/cell-5-output-1.svg){}\n:::\n:::\n\n\nComo se puede observar en la imagen, las gráficas de la función y sus secantes coinciden.\n:::\n\nb. $g(x) = x^2$.  \n¿A qué recta se aproximan las rectas secantes a medida que el intervalo se hace menor?\n\n:::{.callout-tip collapse=\"true\"}\n## Solución\n\n::: {.cell execution_count=5}\n``` {.julia .cell-code}\n# Definimos la función\ng(x) = x ^ 2\n# Construimos las secantes\ns1 = secante(g, 1, 2)\ns2 = secante(g, 1, 1.5)\ns3 = secante(g, 1, 1.1)\ns4 = secante(g, 1, 1.001)\n# Dibujamos las gráficas de la función y las secantes\nplot(g, 0.5, 2.5, label = L\"g(x)\", linewidth = 2)\nplot!([s1, s2, s3, s4], label = [\"Secante [1, 2]\" \"Secante [1, 1.5]\" \"Secante [1, 1.1]\" \"Secante [1, 1.001]\"])\n```\n\n::: {.cell-output .cell-output-display execution_count=107}\n![](concepto-derivada_files/figure-html/cell-6-output-1.svg){}\n:::\n:::\n\n\nComo se puede observar en la imagen, ahora las gráficas de la función y sus secantes no coinciden ya que la tasa de variación media de $g$ en cada intervalo es distinta. \n\nPor otro lado, se observa que a medida que el intervalo se hace menor, la recta secante se aproxima cada vez más a la recta tangente a $g$ en el punto $x=1$.\n:::\n\n### Ejercicio 3 {.unnumbered}\n\nCalcular la tasa de variación instantánea en los puntos $x=1$, $x=2$ y $x=3$ de las siguientes funciones:\n\na. $f(x) = 3x$.\n\n:::{.callout-note collapse=\"true\"}\n## Pista\nLa tasa de variación instantánea de una función $y = f(x)$ en el punto $x=a$ se define como\n\n\n$$ \\mbox{TVI}f(a) = \\lim_{\\Delta x\\rightarrow 0}\\mbox{TVM}f(a,a+\\Delta x) = \\lim_{\\Delta x\\rightarrow 0}\\frac{f(a+\\Delta h)-f(a)}{\\Delta x}.$$\n\n\nRecordemos que cuando existe, la tasa de variación instantánea es la derivada de la función en el punto.\n:::\n\n:::{.callout-tip collapse=\"true\"}\n## Solución\n\n::: {.cell execution_count=6}\n``` {.julia .cell-code}\n@syms h::real\n# Creamos una función para calcular la tasa de variación instantánea\ntvi(f, a) = limit((f(a + h) - f(a)) / h, h => 0)\n# Creamos la función f\nf(x) = 3x\n# Calculamos la tasa de variación instantánea de f los puntos dados\nprintln(tvi(f, 1))\nprintln(tvi(f, 2))\nprintln(tvi(f, 3))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n3\n3\n3\n```\n:::\n:::\n\n\nLa tasa de variación instantánea es constante y no depende del punto. Es por ello que la derivada de la función $f$ es constante y vale $f'(x) = 3$.\n:::\n\nb. $g(x) = x^2$.\n\n:::{.callout-tip collapse=\"true\"}\n## Solución\n\n::: {.cell execution_count=7}\n``` {.julia .cell-code}\n@syms h::real\n# Creamos una función para calcular la tasa de variación instantánea\ntvi(f, a) = limit((f(a + h) - f(a)) / h, h => 0)\n# Creamos la función f\ng(x) = x^2\n# Calculamos la tasa de variación instantánea de f los puntos dados\nprintln(tvi(g, 1))\nprintln(tvi(g, 2))\nprintln(tvi(g, 3))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n2\n4\n6\n```\n:::\n:::\n\n\nLa tasa de variación instantánea no es constante y depende del punto, al igual que la derivada que vale $g'(x) = 2x$.\n:::\n\n### Ejercicio 4 {.unnumbered}\n\nUtilizando la definición de derivada, estudiar la derivabilidad de las siguientes funciones en los puntos dados.\n\na. $f(r) = \\pi r^2$  en $r=1$.\n\n:::{.callout-note collapse=\"true\"}\n## Pista\nLa derivada de una función $f(x)$ en un punto $x=a$ se define como \n\n\n$$f'(a) = lim_{h\\rightarrow 0}\\frac{f(a+h)-f(a)}{h}.$$\n\n:::\n\n:::{.callout-tip collapse=\"true\"}\n## Solución\n\n::: {.cell execution_count=8}\n``` {.julia .cell-code}\n@syms h::real\n# Creamos dos funciones para la derivada por la izquierda y por la derecha\nderivadaI(f, a) = limit((f(a + h) - f(a)) / h, h => 0, dir = \"-\")\nderivadaD(f, a) = limit((f(a + h) - f(a)) / h, h => 0, dir = \"+\")\n# Creamos la función f\nf(r) = PI * r ^ 2 \nprintln(\"Derivada por la izquierda: \", derivadaI(f, 1))\nprintln(\"Derivada por la derecha: \", derivadaD(f, 1))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nDerivada por la izquierda: 2*pi\nDerivada por la derecha: 2*pi\n```\n:::\n:::\n\n\nComo las derivadas por la izquierda y por la derecha coinciden, la función $f$ es derivable en $r=1$ y su derivada vale $f'(1)=2\\pi$.\n:::\n\nb. $g(x) = |x-1|$ en $x=1$.\n\n:::{.callout-tip collapse=\"true\"}\n## Solución\n\n::: {.cell execution_count=9}\n``` {.julia .cell-code}\n# Creamos la función g\ng(x) = abs(x - 1)\nprintln(\"Derivada por la izquierda: \", derivadaI(g, 1))\nprintln(\"Derivada por la derecha: \", derivadaD(g, 1))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nDerivada por la izquierda: -1\nDerivada por la derecha: 1\n```\n:::\n:::\n\n\nComo las derivadas por la izquierda y por la derecha difieren, la función $g$ no es derivable en $x=1$.\n:::\n\n### Ejercicio 5 {.unnumbered}\n\nCalcular la derivada de las siguientes y dar una interpretación en términos físicos o geométricos.\n\na. Área del círculo: $a(r) = \\pi r^2$.\n\n:::{.callout-note collapse=\"true\"}\n## Pista\n\nUsar la función `diff(f)` para calcular la derivada de la función `f`.\n\nLa derivada es la tasa variación instantánea de la variable dependiente con respecto a la independiente de la función.\n:::\n\n:::{.callout-tip collapse=\"true\"}\n## Solución\n\n::: {.cell execution_count=10}\n``` {.julia .cell-code}\n@vars r\narea(r) = PI * r ^ 2 \nprintln(\"Derivada: \", diff(area(r)))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nDerivada: 2*pi*r\n```\n:::\n:::\n\n\nComo $a'(r) = 2\\pi r$ que es el perímetro de la circunferencia de radio $r$, se puede concluir que la tasa de variación instantánea que experimenta el área de un círculo de radio `r` es su perímetro. \n:::\n\nb. Espacio recorrido por un cuerpo en caída libre: $e(t) = a_0 - \\frac{1}{2}g_0t^2$,  \nDonde $a_0$ es la altura inicial y $g_0$ es la aceleración de la gravedad, ambas constantes positivas.\n\n:::{.callout-tip collapse=\"true\"}\n## Solución\n\n::: {.cell execution_count=11}\n``` {.julia .cell-code}\nusing SymPy\n@syms a₀ g₀ t\nespacio(t) = a₀ - g₀ * t ^ 2 / 2\nprintln(\"Derivada: \", diff(espacio(t), t))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nDerivada: -g₀*t\n```\n:::\n:::\n\n\nComo la derivada $e'(t) = -g_0t$ es negativa, en cada instante $t$ el espacio decrece con una velocidad instantánea igual a al gravedad por el instante $t$, y por tanto, cuanto más tiempo pasa, mas rápidamente decrece el espacio.\n:::\n\n### Ejercicio 6 {.unnumbered}\n\nCalcular y dibujar las rectas tangente y normal a la gráfica de la función $f(x) = \\ln(\\sqrt{x + 1}) en $x=1$.\n\n:::{.callout-note collapse=\"true\"}\n## Pista\n\nLa ecuación de la recta tangente a la función $y = f(x)$ en $x=a$ es\n\n\n$$ y = f(a) + f'(a) (x-a)$$\n\n\nY la ecuación de la recta normal a la función $y = f(x)$ en $x=a$ es\n\n\n$$ y = f(a) - \\frac{1}{f'(a)} (x-a)$$\n\n:::\n\n:::{.callout-tip collapse=\"true\"}\n## Solución\n\n::: {.cell execution_count=12}\n``` {.julia .cell-code}\nusing SymPy, Plots, LaTeXStrings\n@syms x \n# Definimos la función\nf(x) = ln(sqrt(x + 1))\n# Calculamos la ecuación de la recta tangente\ntan(x) = f(x)(x => 1) + diff(f(x))(x => 1) * (x - 1)\nprintln(\"Tangente: \", tan(x))\n# Calculamos la ecuación de la recta normal\nnor(x) = f(x)(x => 1) - 1 / diff(f(x))(x => 1) * (x - 1)\nprintln(\"Normal: \", nor(x))\n# Dibujamos las gráficas de la función, la tangente y la normal\nplot(f(x), -0.5, 3, label = L\"f(x)\", linewidth = 2, aspect_ratio = :equal)\nscatter!([1], [f(x)(x => 1)], label = \"\")\nplot!(tan(x), label = \"Tangente\")\nplot!(nor(x), 0.7, 1.3, label = \"Normal\")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nTangente: x/4 - 1/4 + log(sqrt(2))\nNormal: -4*x + log(sqrt(2)) + 4\n```\n:::\n\n::: {.cell-output .cell-output-display execution_count=114}\n![](concepto-derivada_files/figure-html/cell-13-output-2.svg){}\n:::\n:::\n\n\n:::\n\n### Ejercicio 7 {.unnumbered}\n\nCalcular las derivadas de las siguientes funciones hasta el orden 4 y deducir la expresión de la derivada de orden $n$.\n\na. $f(x) = a^x$.\n\n:::{.callout-note collapse=\"true\"}\n## Pista\n\nUsar la función `diff(f, n)` para calcular la derivada de orden `n` de la función `f`.\n:::\n\n:::{.callout-tip collapse=\"true\"}\n## Solución\n\n::: {.cell execution_count=13}\n``` {.julia .cell-code}\n@syms a::real\nf(x) = a ^ x\nprintln(\"Primera derivada: \", diff(f))\nprintln(\"Segunda derivada: \", diff(f, 2))\nprintln(\"Tercera derivada: \", diff(f, 3))\nprintln(\"Cuarta derivada: \", diff(f,4))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nPrimera derivada: a^x*log(a)\nSegunda derivada: a^x*log(a)^2\nTercera derivada: a^x*log(a)^3\nCuarta derivada: a^x*log(a)^4\n```\n:::\n:::\n\n\nSe puede deducir que la derivada de orden $n$ será $f^n(x)=a^x\\ln(a)^n$.\n:::\n\nb. $g(x) = \\frac{\\sin(x)+\\cos(x)}{2}$.\n\n:::{.callout-tip collapse=\"true\"}\n## Solución\n\n::: {.cell execution_count=14}\n``` {.julia .cell-code}\ng(x) = (sin(x) + cos(x)) / 2\nprintln(\"Primera derivada: \", diff(g))\nprintln(\"Segunda derivada: \", diff(g, 2))\nprintln(\"Tercera derivada: \", diff(g, 3))\nprintln(\"Cuarta derivada: \", diff(g,4))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nPrimera derivada: -sin(x)/2 + cos(x)/2\nSegunda derivada: -(sin(x) + cos(x))/2\nTercera derivada: (sin(x) - cos(x))/2\nCuarta derivada: (sin(x) + cos(x))/2\n```\n:::\n:::\n\n\nComo la cuarta derivada coincide con la función original, se puede deducir que la derivada de orden $n$ será \n\n\n$$\n\\DeclareMathOperator{\\sen}{sen}\ng^n(x)=\n\\begin{cases}\n\\frac{\\sen(x)+\\cos(x)}{2}  & \\mbox{si $x=4k$}   \\\\\n\\frac{\\cos(x)-\\sen(x)}{2}  & \\mbox{si $x=4k+1$} \\\\\n\\frac{-\\sen(x)-\\cos(x)}{2} & \\mbox{si $x=4k+2$} \\\\\n\\frac{-\\cos(x)+\\sen(x)}{2} & \\mbox{si $x=4k+3$} \\\\\n\\end{cases}\n\\quad \\mbox{con $k\\in \\mathbb{Z}$}\n$$\n\n:::\n\n## Ejercicios propuestos\n\n### Ejercicio 1 {.unnumbered}\n\nCalcular la tasa de variación media de la función $f(x) = e^{x/2}$ en el intervalo $[0, 1]$.\n\n::: {.cell execution_count=15}\n\n::: {.cell-output .cell-output-display execution_count=117}\n```{=html}\n<form class=\"mx-2 my-3 mw-100\" name='WeaveQuestion' data-id='u8jjoccs' data-controltype=''>\n  <div class='form-group '>\n    <div class='controls'>\n      <div class=\"form\" id=\"controls_u8jjoccs\">\n        <div style=\"padding-top: 5px\">\n    </br>\n<div class=\"input-group\">\n    <input id=\"u8jjoccs\" type=\"number\" class=\"form-control\" placeholder=\"Numeric answer\">\n</div>\n\n    \n        </div>\n      </div>\n      <div id='u8jjoccs_message' style=\"padding-bottom: 15px\"></div>\n    </div>\n  </div>\n</form>\n\n<script text='text/javascript'>\ndocument.getElementById(\"u8jjoccs\").addEventListener(\"change\", function() {\n  var correct = (Math.abs(this.value - 0.6487212707001282) <= 0.001);\n  var msgBox = document.getElementById('u8jjoccs_message');\n    if(correct) {\n    msgBox.innerHTML = \"<div class='pluto-output admonition note alert alert-success'><span> 👍&nbsp; Correct </span></div>\";\n    var explanation = document.getElementById(\"explanation_u8jjoccs\")\n    if (explanation != null) {\n       explanation.style.display = \"none\";\n    }\n  } else {\n    msgBox.innerHTML = \"<div class='pluto-output admonition alert alert-danger'><span>👎&nbsp; Incorrect </span></div>\";\n    var explanation = document.getElementById(\"explanation_u8jjoccs\")\n    if (explanation != null) {\n       explanation.style.display = \"block\";\n    }\n  }\n\n});\n\n</script>\n```\n:::\n:::\n\n\n",
    "supporting": [
      "concepto-derivada_files"
    ],
    "filters": [],
    "includes": {
      "include-in-header": [
        "<script src=\"https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js\" integrity=\"sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==\" crossorigin=\"anonymous\"></script>\n<script src=\"https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js\" integrity=\"sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==\" crossorigin=\"anonymous\"></script>\n<script type=\"application/javascript\">define('jquery', [],function() {return window.jQuery;})</script>\n"
      ]
    }
  }
}